<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Convertisseur webp en ligne - Optimisez vos images sur vos sites web</title>
  <meta name="description" content="Le meilleur convertisseur webp en ligne. Convertissez vos images (.jpg, .jpeg, .png, .gif, .bmp, .tiff) en WebP pour améliorer les performances de votre site et booster votre SEO.">
  <meta name="keywords" content="convertisseur webp, conversion image, outil webp, optimisation image, SEO">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Inclusion de Font Awesome pour les icônes -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
  <style>
    /* Réinitialisation */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    /* Style global */
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
      color: #333;
      line-height: 1.6;
      padding: 20px;
      animation: fadeIn 1s ease-in-out;
    }
    header {
      text-align: center;
      margin-bottom: 30px;
    }
    header h1 {
      font-size: 2.5rem;
      color: #222;
      margin-bottom: 10px;
    }
    header p {
      font-size: 1.2rem;
      color: #555;
    }
    /* Conteneur principal */
    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    /* Boutons et input */
    .button-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
    }
    .button-container input,
    .button-container button {
      margin: 10px 0;
      padding: 12px;
      font-size: 1rem;
      width: 100%;
      max-width: 300px;
      border: none;
      border-radius: 5px;
      transition: all 0.3s ease;
    }
    .button-container input {
      background-color: #f1f1f1;
      cursor: pointer;
    }
    .button-container button {
      background: linear-gradient(45deg, #ff7a18, #af002d 70%);
      color: #fff;
      cursor: pointer;
    }
    .button-container button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .button-container button:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
    }
    /* Container de la sélection de fichiers */
    .file-input-container {
      width: 100%;
      max-width: 300px;
      text-align: center;
      margin-bottom: 10px;
    }
    #selected-files-summary {
      display: none;
      cursor: pointer;
      margin-top: 10px;
      font-size: 0.9rem;
      color: #555;
    }
    #selected-files-list {
      display: none;
      margin-top: 5px;
      text-align: left;
      width: 100%;
      max-width: 300px;
      background: #f9f9f9;
      border: 1px solid #ddd;
      padding: 5px;
      border-radius: 5px;
      font-size: 0.9rem;
      color: #333;
    }
    /* Barre de progression */
    .loader {
      display: none; /* Par défaut masqué */
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 5px;
      margin: 10px 0;
    }
    .loading-text {
      color: #212121; /* Texte visible */
      font-size: 14pt;
      font-weight: 600;
      margin-left: 10px;
    }
    .dot {
      margin-left: 3px;
      animation: blink 1.5s infinite;
    }
    .dot:nth-child(2) {
      animation-delay: 0.3s;
    }
    .dot:nth-child(3) {
      animation-delay: 0.6s;
    }
    .loading-bar-background {
      --height: 30px;
      display: flex;
      align-items: center;
      box-sizing: border-box;
      padding: 5px;
      width: 100%;
      max-width: 300px;
      height: var(--height);
      background-color: #212121;
      box-shadow: #0c0c0c -2px 2px 4px 0px inset;
      border-radius: calc(var(--height) / 2);
    }
    .loading-bar {
      position: relative;
      display: flex;
      justify-content: center;
      flex-direction: column;
      --height: 20px;
      width: 0%;
      height: var(--height);
      overflow: hidden;
      background: linear-gradient(0deg, #28a745 0%, #4dc07d 100%);
      border-radius: calc(var(--height) / 2);
    }
    /* Conteneur des messages */
    #message-container {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #28a745;
      border-radius: 5px;
      background: #eafbea;
      color: #28a745;
      display: none;
      text-align: center;
      font-weight: bold;
    }
    /* Affichage des erreurs */
    #error-container {
      margin-top: 15px;
      padding: 10px;
      border: 1px solid #e74c3c;
      border-radius: 5px;
      background: #fdecea;
      color: #e74c3c;
      display: none;
      text-align: center;
    }
    /* Section SEO et avantages */
    section {
      margin-top: 30px;
      padding: 15px;
      border-top: 1px solid #e0e0e0;
    }
    section h2 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      color: #222;
      text-align: center;
    }
    section p {
      margin-bottom: 10px;
      font-size: 0.8rem;
      color: #555;
      text-align: justify;
    }
    /* Grid des 6 fonctionnalités */
    .features-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 20px;
      margin-top: 20px;
    }
    .feature-item {
      flex: 1 1 45%;
      text-align: center;
      padding: 10px;
    }
    .feature-item i {
      font-size: 2rem;
      color: #28a745;
      text-align: center;
    }
    .feature-item p {
      margin-top: 10px;
      font-size: 0.95rem;
      color: #555;
      text-align: center;
    }
    @media (min-width: 768px) {
      .feature-item {
        flex: 1 1 30%;
      }
    }
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes blink {
      0%, 100% { opacity: 0; }
      50% { opacity: 1; }
    }
    /* Responsive */
    @media (max-width: 600px) {
      header h1 {
        font-size: 2rem;
      }
      header p {
        font-size: 1rem;
      }
      .container {
        padding: 15px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Convertisseur webp en ligne et 100 % gratuit</h1>
    <p>Optimisez vos images pour des performances web exceptionnelles et un SEO renforcé.</p>
  </header>
  
  <div class="container">
    <div class="button-container">
      <!-- Container de sélection de fichiers -->
      <div class="file-input-container">
        <input type="file" id="file-input" accept=".jpg, .jpeg, .png, .gif, .bmp, .tiff" multiple>
        <div id="selected-files-summary">
          <span id="selected-files-label"></span>
          <span id="toggle-arrow" style="margin-left:5px;">▼</span>
        </div>
        <div id="selected-files-list"></div>
      </div>
      
      <button id="convert-btn">Convertir mes images</button>
      
      <!-- Barre de progression (affichée après 5 secondes si besoin) -->
      <div id="loader" class="loader">
        <div class="loading-bar-background">
          <div id="progress-bar" class="loading-bar"></div>
        </div>
        <div class="loading-text">
          Conversion en cours<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>
        </div>
      </div>
      
      <!-- Conteneur des messages de confirmation -->
      <div id="message-container"></div>
      
      <button id="download-btn" disabled>Télécharger</button>
    </div>
    
    <!-- Conteneur des erreurs -->
    <div id="error-container"></div>
    
    <!-- Section SEO et avantages -->
    <section>
      <h2>Pourquoi choisir notre <br>convertisseur webp ?</h2>
      
      <!-- Grille des 6 fonctionnalités -->
      <div class="features-grid">
        <div class="feature-item">
          <i class="fas fa-dollar-sign"></i>
          <p>100 % gratuit<br>Pas d'abonnement payant</p>
        </div>
        <div class="feature-item">
          <i class="fas fa-infinity"></i>
          <p>Nombre de conversions illimitées</p>
        </div>
        <div class="feature-item">
          <i class="fas fa-mobile-alt"></i>
          <p>Compatible avec tous les appareils,<br>desktop et mobile</p>
        </div>
        <div class="feature-item">
          <i class="fas fa-bolt"></i>
          <p>Conversion rapide et fiable</p>
        </div>
        <div class="feature-item">
          <i class="fas fa-user-friends"></i>
          <p>Interface intuitive et facile à utiliser</p>
        </div>
        <div class="feature-item">
          <i class="fas fa-lock"></i>
          <p>Sécurité et confidentialité assurées</p>
        </div>
      </div>

      <p>
        Notre convertisseur WebP en ligne est l'outil incontournable pour transformer vos images (.jpg, .jpeg, .png, .gif, .bmp, .tiff) en format WebP. En optimisant vos images, vous améliorez non seulement la vitesse de chargement de votre site, mais vous boostez également votre référencement naturel (SEO).
      </p>
      <p>
        Conçu pour répondre aux besoins des développeurs, webmasters et designers, notre service de conversion est rapide, fiable et 100 % en ligne, accessible sur tous vos appareils.
      </p>
      <p>
        Comptabible sur tous les navigateurs (Chrome, Brave, Edge, Sarafi, Firefox...). Pensez à utiliser la dernière version de votre navigateur. 
      </p>
      
    </section>
  </div>

  <!-- Inclusion de JSZip et FileSaver depuis un CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script>
    const fileInput   = document.getElementById('file-input');
    const convertBtn  = document.getElementById('convert-btn');
    const downloadBtn = document.getElementById('download-btn');
    const loader      = document.getElementById('loader');
    const progressBar = document.getElementById('progress-bar');
    const errorContainer   = document.getElementById('error-container');
    const messageContainer = document.getElementById('message-container');
    let zip = new JSZip();
    let convertedFiles = [];
    let progressBarShown = false;
    let progressTimer;
    
    // Gestion de la sélection de fichiers et mise à jour du container associé
    fileInput.addEventListener("change", function() {
      const files = fileInput.files;
      const summary = document.getElementById("selected-files-summary");
      const label = document.getElementById("selected-files-label");
      const fileListContainer = document.getElementById("selected-files-list");
      if (files.length > 0) {
        label.textContent = files.length + (files.length > 1 ? " fichiers sélectionnés" : " fichier sélectionné");
        summary.style.display = "block";
        // Afficher la flèche uniquement s'il y a plusieurs fichiers
        document.getElementById("toggle-arrow").style.display = files.length > 1 ? "inline" : "none";
        // Construire la liste des fichiers
        let listHTML = "<ul style='list-style: none; padding-left: 0; margin: 0;'>";
        for (let i = 0; i < files.length; i++) {
          listHTML += "<li>" + files[i].name + "</li>";
        }
        listHTML += "</ul>";
        fileListContainer.innerHTML = listHTML;
        fileListContainer.style.display = "none"; // initialement masquée
      } else {
        summary.style.display = "none";
        fileListContainer.style.display = "none";
      }
    });
    
    // Toggle pour afficher/masquer la liste des fichiers sélectionnés
    document.getElementById("selected-files-summary").addEventListener("click", function() {
      const fileListContainer = document.getElementById("selected-files-list");
      const toggleArrow = document.getElementById("toggle-arrow");
      if (fileListContainer.style.display === "none") {
        fileListContainer.style.display = "block";
        toggleArrow.textContent = "▲";
      } else {
        fileListContainer.style.display = "none";
        toggleArrow.textContent = "▼";
      }
    });
    
    // Fonction de conversion d'un fichier image en WebP via canvas
    function convertFile(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = function(event) {
          const img = new Image();
          img.onload = function() {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            // Conversion vers le format WebP
            canvas.toBlob(function(blob) {
              if (blob) {
                const newName = file.name.replace(/\.(jpg|jpeg|png|gif|bmp|tiff)$/i, '.webp');
                resolve({ name: newName, blob: blob });
              } else {
                reject(new Error('La conversion a échoué pour ' + file.name));
              }
            }, 'image/webp');
          };
          img.onerror = function() {
            reject(new Error('Erreur lors du chargement de l\'image ' + file.name));
          };
          img.src = event.target.result;
        };
        reader.onerror = function() {
          reject(new Error('Erreur de lecture du fichier ' + file.name));
        };
        reader.readAsDataURL(file);
      });
    }
    
    // Gestion de l'événement "Convertir"
    convertBtn.addEventListener('click', async () => {
      const files = fileInput.files;
      errorContainer.style.display = "none";
      errorContainer.innerHTML = "";
      messageContainer.style.display = "none";
      messageContainer.innerHTML = "";
      
      if (files.length === 0) {
        messageContainer.innerHTML = "Veuillez sélectionner au moins un fichier.";
        messageContainer.style.display = "block";
        return;
      }
      
      // Démarrage d'un timer pour afficher la barre de progression après 5 secondes
      progressBarShown = false;
      progressTimer = setTimeout(() => {
        loader.style.display = "flex";
        progressBarShown = true;
      }, 5000);
      
      // Réinitialisation du zip et de la liste des fichiers convertis
      zip = new JSZip();
      convertedFiles = [];
      
      // Désactivation des boutons pendant la conversion
      convertBtn.disabled = true;
      fileInput.disabled  = true;
      downloadBtn.disabled = true;
      
      let errorMessages = [];
      
      for (let i = 0; i < files.length; i++) {
        try {
          const converted = await convertFile(files[i]);
          zip.file(converted.name, converted.blob);
          convertedFiles.push(converted);
        } catch (error) {
          console.error(error);
          errorMessages.push(error.message);
        }
        // Mise à jour de la barre de progression si elle est visible
        if (progressBarShown) {
          const progress = ((i + 1) / files.length) * 100;
          progressBar.style.width = progress + "%";
        }
      }
      
      // Annulation du timer si conversion terminée avant 5 sec
      clearTimeout(progressTimer);
      // Masquer le loader s'il était affiché
      loader.style.display = "none";
      
      // Affichage des erreurs éventuelles
      if (errorMessages.length > 0) {
        errorContainer.innerHTML = errorMessages.join("<br>");
        errorContainer.style.display = "block";
      }
      
      // Réactivation des boutons après conversion
      convertBtn.disabled = false;
      fileInput.disabled  = false;
      downloadBtn.disabled = false;
      
      // Affichage d'un message de confirmation
      messageContainer.innerHTML = "Votre conversion est terminée ! 🚀";
      messageContainer.style.display = "block";
    });
    
    // Gestion de l'événement "Télécharger"
    downloadBtn.addEventListener('click', async () => {
      if (convertedFiles.length === 0) {
        messageContainer.innerHTML = "Aucun fichier converti à télécharger.";
        messageContainer.style.display = "block";
        return;
      }
      try {
        // Si une seule image convertie, téléchargement direct
        if (convertedFiles.length === 1) {
          const file = convertedFiles[0];
          saveAs(file.blob, file.name);
        } else {
          const content = await zip.generateAsync({ type: "blob" });
          saveAs(content, "images_webp.zip");
        }
      } catch (error) {
        console.error(error);
        messageContainer.innerHTML = "Erreur lors du téléchargement : " + error.message;
        messageContainer.style.display = "block";
      }
    });
  </script>
</body>
</html>
