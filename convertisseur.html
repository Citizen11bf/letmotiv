<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Convertisseur d'images en WebP <br> - Optimisez vos images en ligne et 100 % gratuit </title>
  <meta name="description" content="Le meilleur convertisseur WebP en ligne. Convertissez vos images (.jpg, .jpeg, .png, .gif, .bmp, .tiff) en WebP pour améliorer les performances de votre site et booster votre SEO.">
  <meta name="keywords" content="convertisseur webp, conversion image, outil webp, optimisation image, SEO">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Réinitialisation */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    /* Style global */
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
      color: #333;
      line-height: 1.6;
      padding: 20px;
      animation: fadeIn 1s ease-in-out;
    }
    header {
      text-align: center;
      margin-bottom: 30px;
    }
    header h1 {
      font-size: 2.5rem;
      color: #222;
      margin-bottom: 10px;
    }
    header p {
      font-size: 1.2rem;
      color: #555;
    }
    /* Conteneur principal */
    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    /* Boutons et input */
    .button-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
    }
    .button-container input,
    .button-container button {
      margin: 10px 0;
      padding: 12px;
      font-size: 1rem;
      width: 100%;
      max-width: 300px;
      border: none;
      border-radius: 5px;
      transition: all 0.3s ease;
    }
    .button-container input {
      background-color: #f1f1f1;
      cursor: pointer;
    }
    .button-container button {
      background: linear-gradient(45deg, #ff7a18, #af002d 70%);
      color: #fff;
      cursor: pointer;
    }
    .button-container button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .button-container button:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
    }
    /* Barre de progression */
    .loader {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 5px;
      margin-top: 20px;
    }
    .loading-text {
      color: #fff;
      font-size: 14pt;
      font-weight: 600;
      margin-left: 10px;
    }
    .dot {
      margin-left: 3px;
      animation: blink 1.5s infinite;
    }
    .dot:nth-child(2) {
      animation-delay: 0.3s;
    }
    .dot:nth-child(3) {
      animation-delay: 0.6s;
    }
    .loading-bar-background {
      --height: 30px;
      display: flex;
      align-items: center;
      box-sizing: border-box;
      padding: 5px;
      width: 100%;
      max-width: 300px;
      height: var(--height);
      background-color: #212121;
      box-shadow: #0c0c0c -2px 2px 4px 0px inset;
      border-radius: calc(var(--height) / 2);
    }
    .loading-bar {
      position: relative;
      display: flex;
      justify-content: center;
      flex-direction: column;
      --height: 20px;
      width: 0%;
      height: var(--height);
      overflow: hidden;
      background: linear-gradient(0deg, rgba(222, 74, 15, 1) 0%, rgba(249, 199, 79, 1) 100%);
      border-radius: calc(var(--height) / 2);
    }
    .white-bars-container {
      position: absolute;
      display: flex;
      align-items: center;
      gap: 18px;
    }
    .white-bar {
      background: linear-gradient(-45deg, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 70%);
      width: 10px;
      height: 45px;
      opacity: 0.3;
      transform: rotate(45deg);
    }
    /* Affichage des erreurs */
    #error-container {
      margin-top: 15px;
      padding: 10px;
      border: 1px solid #e74c3c;
      border-radius: 5px;
      background: #fdecea;
      color: #e74c3c;
      display: none;
      text-align: center;
    }
    /* Section SEO */
    section {
      margin-top: 30px;
      padding: 15px;
      border-top: 1px solid #e0e0e0;
    }
    section h2 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      color: #222;
    }
    section p {
      margin-bottom: 10px;
      font-size: 1rem;
      color: #555;
      text-align: justify;
    }
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes blink {
      0%, 100% { opacity: 0; }
      50% { opacity: 1; }
    }
    /* Responsive */
    @media (max-width: 600px) {
      header h1 {
        font-size: 2rem;
      }
      header p {
        font-size: 1rem;
      }
      .container {
        padding: 15px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Convertisseur WebP en Ligne</h1>
    <p>Optimisez vos images pour des performances web exceptionnelles et un SEO renforcé.</p>
  </header>
  
  <div class="container">
    <div class="button-container">
      <!-- Prise en charge des formats supplémentaires -->
      <input type="file" id="file-input" accept=".jpg, .jpeg, .png, .gif, .bmp, .tiff" multiple>
      <button id="convert-btn">Convertir mes images</button>
      <button id="download-btn" disabled>Télécharger</button>
    </div>
    
    <!-- Barre de progression -->
    <div id="loader" class="loader" style="display: none;">
      <div class="loading-bar-background">
        <div id="progress-bar" class="loading-bar"></div>
      </div>
      <div class="loading-text">
        Conversion en cours<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>
      </div>
    </div>
    
    <!-- Conteneur des erreurs -->
    <div id="error-container"></div>
    
    <!-- Contenu SEO optimisé -->
    <section>
      <h2>Pourquoi choisir notre convertisseur d'images en .webP ?</h2>
      <p>
        Notre convertisseur webP en ligne est l'outil incontournable pour transformer vos principaux formats d'image (.jpg, .jpeg, .png, .gif, .bmp, .tiff) en format WebP. En optimisant vos images, vous améliorez non seulement la vitesse de chargement de votre site, mais vous boostez également votre référencement naturel (SEO).
      </p>
      <p>
        Idéal pour les développeurs, webmasters et designers, notre service propose une conversion rapide, fiable et 100% en ligne, compatible avec tous les appareils – desktop comme mobile.
      </p>
      <p>
        Pas de compte. Pas d'abonnement. Pas d'argent. Adoptez dès maintenant notre convertisseur webP et profitez d’un outil performant qui vous permettra de gagner en efficacité tout en offrant une expérience utilisateur améliorée.
      </p>
    </section>
  </div>

  <!-- Inclusion de JSZip et FileSaver depuis un CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script>
    const fileInput   = document.getElementById('file-input');
    const convertBtn  = document.getElementById('convert-btn');
    const downloadBtn = document.getElementById('download-btn');
    const loader      = document.getElementById('loader');
    const progressBar = document.getElementById('progress-bar');
    const errorContainer = document.getElementById('error-container');
    let zip = new JSZip();
    let convertedFiles = [];
    
    // Fonction de conversion d'un fichier image en WebP via canvas
    function convertFile(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = function(event) {
          const img = new Image();
          img.onload = function() {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            // Conversion vers le format WebP
            canvas.toBlob(function(blob) {
              if (blob) {
                // Remplacement de l'extension par .webp
                const newName = file.name.replace(/\.(jpg|jpeg|png|gif|bmp|tiff)$/i, '.webp');
                resolve({ name: newName, blob: blob });
              } else {
                reject(new Error('La conversion a échoué pour ' + file.name));
              }
            }, 'image/webp');
          };
          img.onerror = function() {
            reject(new Error('Erreur lors du chargement de l\'image ' + file.name));
          };
          img.src = event.target.result;
        };
        reader.onerror = function() {
          reject(new Error('Erreur de lecture du fichier ' + file.name));
        };
        reader.readAsDataURL(file);
      });
    }
    
    // Gestion de l'événement "Convertir"
    convertBtn.addEventListener('click', async () => {
      const files = fileInput.files;
      errorContainer.style.display = "none";
      errorContainer.innerHTML = "";
      
      if (files.length === 0) {
        alert("Veuillez sélectionner au moins un fichier.");
        return;
      }
      
      // Affichage de la barre de progression
      loader.style.display = "flex";
      progressBar.style.width = "0%";
      
      // Réinitialisation du zip et de la liste des fichiers convertis
      zip = new JSZip();
      convertedFiles = [];
      
      // Désactivation des boutons pendant la conversion
      convertBtn.disabled = true;
      fileInput.disabled  = true;
      downloadBtn.disabled = true;
      
      let errorMessages = [];
      
      for (let i = 0; i < files.length; i++) {
        try {
          const converted = await convertFile(files[i]);
          zip.file(converted.name, converted.blob);
          convertedFiles.push(converted);
        } catch (error) {
          console.error(error);
          errorMessages.push(error.message);
        }
        // Mise à jour de la barre de progression
        const progress = ((i + 1) / files.length) * 100;
        progressBar.style.width = progress + "%";
      }
      
      // Affichage des erreurs s'il y en a eu
      if (errorMessages.length > 0) {
        errorContainer.innerHTML = errorMessages.join("<br>");
        errorContainer.style.display = "block";
      }
      
      // Réactivation des boutons après conversion
      convertBtn.disabled = false;
      fileInput.disabled  = false;
      downloadBtn.disabled = false;
      
      alert("Conversion terminée !");
      // Masquer la barre de progression après un court délai
      setTimeout(() => {
        loader.style.display = "none";
      }, 1000);
    });
    
    // Gestion de l'événement "Télécharger"
    downloadBtn.addEventListener('click', async () => {
      if (convertedFiles.length === 0) {
        alert("Aucun fichier converti à télécharger.");
        return;
      }
      try {
        // Si une seule image convertie, téléchargement direct
        if (convertedFiles.length === 1) {
          const file = convertedFiles[0];
          saveAs(file.blob, file.name);
        } else {
          // Sinon, création et téléchargement d'un zip
          const content = await zip.generateAsync({ type: "blob" });
          saveAs(content, "images_webp.zip");
        }
      } catch (error) {
        console.error(error);
        alert("Une erreur est survenue lors du téléchargement : " + error.message);
      }
    });
  </script>
</body>
</html>
