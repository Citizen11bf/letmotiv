<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simulateur d'entretiens</title>
  <meta name="description" content="Préparez vos entretiens grâce au simulateur spécialisé Letmotiv. Exercez-vous pour réussir votre admission ou votre embauche.">

  <!-- Icône de la page (favicon) -->
  <link rel="icon" href="https://img.icons8.com/fluency/48/000000/microphone.png" type="image/png">
  <link rel="apple-touch-icon" href="https://img.icons8.com/fluency/48/182d84/microphone.png">
  
  <!-- Balises Open Graph -->
  <meta property="og:title" content="Simulateur d'entretiens" />
  <meta property="og:description" content="Préparez vos entretiens grâce au simulateur spécialisé Letmotiv." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://letmotiv-simulateur.fr" />
  <meta property="og:image" content="https://i.postimg.cc/LXxJLTVx/Letmotiv-og-image.png" />
  <meta property="og:image:alt" content="Illustration d'un entretien professionnel." />
  <meta name="author" content="Simulateur d'entretiens" />
  <meta property="article:published_time" content="2025-01-26" />

  <!-- Balises Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Simulateur d'entretiens">
  <meta name="twitter:description" content="Préparez vos entretiens grâce au simulateur spécialisé Letmotiv.">
  <meta name="twitter:image" content="https://i.postimg.cc/LXxJLTVx/Letmotiv-og-image.png">

  <!-- Import de Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans&family=Montserrat:wght@700&display=swap" rel="stylesheet" />

  <!-- Icônes Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  
  <!-- Hammer.js pour les gestes sur mobile -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>

  <!-- JSON-LD pour le SEO -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Simulateur d'entretiens",
      "url": "https://letmotiv-simulateur.fr",
      "description": "Préparez vos entretiens et admissions grâce au simulateur spécialisé letmotiv.",
      "publisher": {
        "@type": "Organization",
        "name": "Letmotiv",
        "logo": "https://letmotiv-simulateur.fr/logo.png"
      }
    }
  </script>
  
  <!-- Styles CSS -->
  <style>
    /* --- GLOBAL --- */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'DM Sans', sans-serif;
      background-color: #ffffff;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
      padding-top: 60px;
      padding-bottom: 20px;
    }

    /* --- HEADER --- */
    .header {
      background-color: #182d84;
      color: #fff;
      font-size: 16px;
      font-weight: bold;
      text-align: center;
      padding: 10px;
      width: 100%;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 10;
    }
    .header-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }
    .header-l2 {
      font-size: 14px;
      font-weight: normal;
    }

    /* --- BARRE DE PROGRESSION --- */
    .progress-container {
      position: fixed;
      top: 60px;
      left: 0;
      width: 100%;
      height: 8px;
      background-color: rgba(24,45,132,0.1);
      z-index: 9;
    }
    .progress-bar {
      width: 0%;
      height: 100%;
      background-color: #00a48a;
      transition: width 0.5s ease;
    }

    /* --- BOÎTE D'INTRODUCTION --- */
    .intro-box {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #182d84, #00a48a);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #fff;
      z-index: 20;
      animation: fadeIn 1s ease forwards;
    }
    .intro-box h1 {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.5rem;
      margin-bottom: 30px;
      animation: slideDown 1s ease forwards;
    }
    .intro-box button {
      background-color: #fff;
      color: #182d84;
      font-family: 'DM Sans', sans-serif;
      font-size: 1.2rem;
      border: none;
      border-radius: 25px;
      padding: 15px 30px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.3s, color 0.3s;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    .intro-box button:hover {
      background-color: #00a48a;
      color: #fff;
      transform: scale(1.05);
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
    @keyframes slideDown { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    /* --- CONTENEUR PRINCIPAL --- */
    .main-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex-grow: 1;
      width: 100%;
      padding: 20px;
    }

    /* --- BOXES (étapes) --- */
    .box {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: 20px 0;
      padding: 20px;
      border-radius: 15px;
      background: linear-gradient(135deg, #fff, #f9f9f9);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      text-align: center;
      font-size: 14px;
      display: none;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .box.active { display: block; }
    .box:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0,0,0,0.15); }

    /* --- ANIMATIONS VERTICALES --- */
    .slide-from-bottom { animation: fromBottom 1.5s ease forwards; }
    @keyframes fromBottom { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
    .slide-from-top { animation: fromTop 1.5s ease forwards; }
    @keyframes fromTop { from { opacity: 0; transform: translateY(-50px); } to { opacity: 1; transform: translateY(0); } }

    /* --- HEADER INTERNE DES BOXES --- */
    .box-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
      position: relative;
    }
    .back-btn {
      border: none;
      background-color: #808080;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s, transform 0.3s;
      margin-bottom: 10px;
    }
    .back-btn:hover { background-color: #505050; transform: scale(1.1); }
    .back-btn:active { background-color: #303030; }
    #step1 .back-btn.hidden-visibility { display: none; }
    .box-title { font-size: 18px; font-weight: bold; color: #182d84; text-align: center; }

    /* --- FLECHES HAUT/BAS --- */
    .next-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #182d84;
      background-color: transparent;
      color: #182d84;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s, transform 0.3s;
      margin: 10px auto;
    }
    .next-btn:hover { background-color: #00a48a; color: #fff; transform: scale(1.05); }
    .next-btn.pulse { animation: electricPulse 1.5s infinite; }
    @keyframes electricPulse {
      0% { box-shadow: 0 0 0 0 rgba(0,164,138,0.7); }
      70% { box-shadow: 0 0 0 10px rgba(0,164,138,0); }
      100% { box-shadow: 0 0 0 0 rgba(0,164,138,0); }
    }

    /* --- Boutons de style (ex. "Démarrer ton impro") --- */
    .btn-impro {
      margin: 15px 0;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .btn-impro:hover { background-color: #00a48a; }

    /* --- STEP1 : Objectifs d'entretien --- */
    .objectives-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
      justify-items: center;
      margin: 10px 0;
    }
    .objective-item {
      text-align: center;
      color: #444;
      font-size: 1rem;
      cursor: pointer;
      padding: 12px;
      border: 1px solid transparent;
      border-radius: 10px;
      transition: background-color 0.3s, border-color 0.3s, transform 0.3s;
    }
    .objective-item i {
      font-size: 2rem;
      margin-bottom: 8px;
      display: block;
      color: #444;
    }
    .objective-item:hover {
      border-color: #00a48a;
      background-color: rgba(0,164,138,0.1);
    }
    .objective-item.selected-objective {
      transform: scale(1.1);
      background-color: rgba(0,164,138,0.2);
      color: #00a48a;
      border-color: #00a48a;
      transition: all 0.3s ease-in-out;
    }
    .objective-item.selected-objective i { color: #00a48a; }

    /* Personnalisation des couleurs et icônes pour chaque objectif */
    .objective-item[data-category="les-mines"] i { color: #FF9800; } /* icône Les Mines */
    .objective-item[data-category="sciences-po"] i { color: #9C27B0; } /* Sciences Po */
    .objective-item[data-category="aeronautique"] i { color: #03A9F4; } /* Aéronautique & Aérospatial */
    .objective-item[data-category="polytechnique"] i { color: #E91E63; } /* Polytechnique */
    .objective-item[data-category="ens"] i { color: #4CAF50; } /* ENS */
    .objective-item[data-category="embauche"] i { color: #607D8B; } /* Embauche */
    .objective-item[data-category="cpge"] i { color: #3F51B5; } /* CPGE Classes Prépa */
    .objective-item[data-category="hec"] i { color: #F44336; } /* HEC */

    /* Bulle d'explication */
    .explanation-box {
      visibility: hidden;
      opacity: 0;
      transform: translateY(-10px);
      margin: 10px auto;
      background-color: #fefefe;
      border: 0 solid #ccc;
      border-radius: 8px;
      padding: 10px;
      text-align: center;
      font-weight: bold;
      font-size: 14px;
      font-style: italic;
      color: #333;
      transition: border 0.5s ease, opacity 0.5s ease, transform 0.5s ease;
      max-width: 90%;
    }
    .explanation-box.show {
      visibility: visible;
      opacity: 1;
      transform: translateY(0);
      border: 2px solid #ccc;
    }

    /* --- STEP2 : Génération du sujet --- */
    .subject-wrapper {
      margin-top: 10px;
      background-color: #fefefe;
      border: 2px solid #ccc;
      border-radius: 8px;
      padding: 10px;
      text-align: center;
      font-size: 14px;
      font-style: italic;
      color: #333;
      display: none;
    }
    
    /* --- STEP3 : Enregistrement vidéo --- */
    .video-box {
      margin: 10px auto;
      border: 3px solid #182d84;
      border-radius: 6px;
      max-width: 500px;
      background-color: #fefefe;
      height: 300px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      transition: height 0.5s ease-in-out;
    }
    .video-box video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 4px;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
      transform: scaleX(-1);
      -webkit-transform: scaleX(-1);
    }
    .video-overlay {
      position: absolute;
      z-index: 2;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: #555;
      font-style: italic;
      font-size: 14px;
      padding: 20px;
      background: rgba(255,255,255,0.6);
    }
    .video-overlay p { margin: 10px 0; }
    .video-overlay button {
      margin: 15px 0;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .video-overlay button:hover { background-color: #00a48a; }
    .recording-indicator {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      align-items: center;
      background-color: rgba(255,255,255,0.8);
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 14px;
      color: #ff0000;
      display: none;
      z-index: 3;
    }
    .recording-indicator .dot {
      height: 10px;
      width: 10px;
      background-color: #ff0000;
      border-radius: 50%;
      display: inline-block;
      margin-right: 5px;
      animation: blink 1s infinite;
    }
    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
    .countdown {
      position: absolute;
      bottom: 10px;
      right: 10px;
      font-size: 24px;
      color: #fff;
      display: none;
      z-index: 4;
      background-color: rgba(0,0,0,0.5);
      padding: 5px 10px;
      border-radius: 5px;
      text-align: center;
    }
    .initial-countdown-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(128,128,128,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 5;
      border-radius: 6px;
    }
    .initial-countdown {
      font-size: 48px;
      color: #fff;
      font-weight: bold;
    }

    .impro-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 10px;
    }
    .hidden-btn { display: none; }

    /* --- STEP4 : Analyse et Téléchargements --- */
    .download-section { margin-top: 20px; }
    .download-section-accent {
      background: linear-gradient(135deg, #182d84, #00a48a);
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      color: #fff;
      margin-bottom: 20px;
      animation: fadeInDown 0.6s ease forwards;
    }
    .download-section-accent h2 {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.5rem;
      margin: 0 0 10px;
    }
    .download-section-accent .subtitle {
      font-style: italic;
      margin-bottom: 10px;
    }
    .download-section-accent .reassure {
      font-size: 0.9rem;
      opacity: 0.9;
    }
    .call-to-action { text-align: center; }
    .call-to-action button {
      background-color: #ffcb2d;
      color: #000;
      border-radius: 30px;
      padding: 12px 24px;
      font-weight: bold;
      font-size: 1rem;
      transition: transform 0.2s, box-shadow 0.2s;
      margin: 10px auto;
    }
    .call-to-action button:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    .download-buttons {
      margin-top: 20px;
      text-align: center;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.4s ease, transform 0.4s ease;
      display: none;
    }
    .download-buttons.show {
      opacity: 1;
      transform: translateY(0);
      display: block;
    }
    .success-message {
      color: #28a745;
      background-color: #d4edda;
      border: 1px solid #c3e6cb;
      border-radius: 5px;
      padding: 10px 20px;
      margin-top: 10px;
      font-weight: bold;
      text-align: center;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    .success-message.show {
      display: block;
      opacity: 1;
      visibility: visible;
    }
    @keyframes fadeInDown {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    /* --- Bulle style pour le sujet --- */
    .subject-bubble {
      display: inline-block;
      position: relative;
      background: #fefefe;
      border: 2px solid #ccc;
      border-radius: 16px;
      padding: 10px 15px;
      font-size: 16px;
      color: #333;
      max-width: 80%;
      text-align: center;
      margin: 0 auto;
    }

    /* --- Messages d'erreur --- */
    .error-message {
      color: red;
      margin-top: 10px;
      font-weight: bold;
      display: none;
      text-align: center;
      width: 100%;
    }

    /* --- Champs Prénom et Email --- */
    .download-fields {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      margin-bottom: 15px;
    }
    .input-group {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      width: 48%;
    }
    .input-group label {
      margin-bottom: 5px;
      font-weight: bold;
      color: #000;
    }
    .input-group input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-family: 'DM Sans', sans-serif;
      font-size: 14px;
      transition: border-color 0.3s;
    }
    .input-group input:focus {
      border-color: #00a48a;
      outline: none;
    }

    /* --- Bouton de partage LinkedIn --- */
    .linkedin-share-btn {
      position: fixed;
      bottom: 15px;
      right: 15px;
      background-color: #0077B5;
      color: #fff;
      font-size: 14px;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      transition: background-color 0.3s, transform 0.2s;
      z-index: 100;
    }
    .linkedin-share-btn:hover { background-color: #005582; transform: scale(1.1); }
    .linkedin-share-btn i { font-size: 18px; }
  </style>
</head>
<body>
  <!-- BOÎTE D'INTRODUCTION -->
  <div class="intro-box" id="intro-box">
    <h1>Prépare ton entretien</h1>
    <button id="start-intro-btn" aria-label="Commencer">Commencer</button>
  </div>

  <!-- FORMULAIRE CACHÉ POUR GOOGLE FORMS -->
  <form id="hidden-google-form" action="https://docs.google.com/forms/d/e/1FAIpQLSfGAcKp0cV5AeVJCJBPbtKLKCLhbYySZf_FkiMg85WKVFUn6A/formResponse" method="POST" target="hidden_iframe" style="display:none;">
    <input type="text" name="entry.1119647353" id="hidden-prenom">
    <input type="email" name="entry.638831312" id="hidden-email">
  </form>
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

  <!-- HEADER -->
  <div class="header">
    <div class="header-content">
      <div class="header-l1">Coaching d'entretiens</div>
      <div class="header-l2">Simulateur spécialisé</div>
    </div>
  </div>

  <!-- BARRE DE PROGRESSION -->
  <div class="progress-container">
    <div class="progress-bar" id="top-progress-bar"></div>
  </div>

  <!-- CONTAINER PRINCIPAL -->
  <div class="main-container">
    <!-- Les étapes du simulateur -->

    <!-- STEP1 : Choix d'objectif -->
    <!-- Ce bloc gère la sélection des objectifs (écoles et types d'entretien) -->
    <div class="box" id="step1">
      <div class="box-header">
        <button class="back-btn hidden-visibility" id="back-btn1" aria-label="Retour">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Quel entretien souhaites-tu préparer ?</div>
      </div>
      <div class="objectives-container">
        <div class="objective-item" data-category="les-mines">
          <i class="fas fa-industry"></i>
          <span>Les Mines</span>
        </div>
        <div class="objective-item" data-category="sciences-po">
          <i class="fas fa-landmark"></i>
          <span>Sciences Po</span>
        </div>
        <div class="objective-item" data-category="aeronautique">
          <i class="fas fa-plane"></i>
          <span>Aéronautique & Aérospatial</span>
        </div>
        <div class="objective-item" data-category="polytechnique">
          <i class="fas fa-graduation-cap"></i>
          <span>Polytechnique</span>
        </div>
        <div class="objective-item" data-category="ens">
          <i class="fas fa-desktop"></i>
          <span>ENS</span>
        </div>
        <div class="objective-item" data-category="embauche">
          <i class="fas fa-briefcase"></i>
          <span>Embauche</span>
        </div>
        <div class="objective-item" data-category="cpge">
          <i class="fas fa-chalkboard-teacher"></i>
          <span>CPGE Classes Prépa</span>
        </div>
        <div class="objective-item" data-category="hec">
          <i class="fas fa-chart-line"></i>
          <span>HEC</span>
        </div>
      </div>
      <!-- Bulle d'explication affichant la description de l'objectif -->
      <div id="explanation-box" class="explanation-box"></div>
      <!-- Message d'erreur si aucun objectif n'est sélectionné -->
      <div id="objective-error" class="error-message"></div>
      <!-- Bouton Suivant pour passer à l'étape suivante -->
      <button class="next-btn" id="next-btn1" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP2 : Génération du sujet -->
    <!-- Ce bloc affiche l'objectif sélectionné et permet de générer un sujet aléatoire -->
    <div class="box" id="step2">
      <div class="box-header">
        <button class="back-btn" id="back-btn2" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Ton entretien</div>
      </div>
      <!-- Affichage de la description de l'objectif sélectionné -->
      <p id="selected-objective-display" style="font-weight:bold; margin-bottom:10px;"></p>
      <!-- Bouton pour générer un sujet aléatoire -->
      <button id="generate-subject-btn" class="btn-impro">Générer un sujet</button>
      <div id="subject-wrapper" class="subject-wrapper">
        <span id="subject-display"></span>
      </div>
      <div id="subject-error" class="error-message"></div>
      <!-- Bouton Suivant pour passer à l'enregistrement -->
      <button class="next-btn" id="next-btn2" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP3 : Enregistrement vidéo -->
    <!-- Ce bloc gère l'enregistrement vidéo de l'entretien simulé -->
    <div class="box" id="step3">
      <div class="box-header">
        <button class="back-btn" id="back-btn3" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Passe en mode simulation</div>
      </div>
      <!-- Affichage du sujet généré -->
      <div id="current-subject-display" class="subject-bubble"></div>
      <div class="video-box">
        <video id="preview" autoplay muted playsinline webkit-playsinline></video>
        <!-- Overlay avec instructions pour démarrer l'enregistrement -->
        <div class="video-overlay">
          <p>Ici, ta simulation d'entretien va s'enregistrer. Quand tu es prêt, clique sur le bouton ci-dessous.</p>
          <button id="start-btn" aria-label="Démarrer la simulation">
            Démarrer la simulation <i class="fas fa-video"></i>
          </button>
          <p>NB : La vidéo reste sur ton appareil.</p>
        </div>
        <div class="recording-indicator" id="recording-indicator">
          <span class="dot"></span> Enregistrement...
        </div>
        <div class="countdown" id="countdown">1:59</div>
        <div class="initial-countdown-overlay" id="initial-countdown-overlay">
          <div class="initial-countdown" id="initial-countdown">3</div>
        </div>
      </div>
      <!-- Boutons pour arrêter ou recommencer l'enregistrement -->
      <div class="impro-actions">
        <button id="stop-btn" class="hidden-btn btn-impro" aria-label="Arrêter l'enregistrement">
          Arrêter <i class="fas fa-stop"></i>
        </button>
        <button id="restart-btn" class="hidden-btn btn-impro" aria-label="Recommencer l'enregistrement">
          Recommencer <i class="fas fa-redo"></i>
        </button>
      </div>
      <div id="impro-error" class="error-message"></div>
      <!-- Bouton Suivant pour passer à l'analyse -->
      <button class="next-btn" id="next-btn3" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP4 : Analyse et Téléchargements -->
    <!-- Ce bloc permet de saisir vos infos pour recevoir vos ressources -->
    <div class="box" id="step5">
      <div class="box-header">
        <button class="back-btn" id="back-btn5" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Analyse ta simulation</div>
      </div>
      <div class="download-section">
        <div class="download-section-accent">
          <h2>Obtiens ta vidéo et ta grille d'analyse</h2>
          <p class="subtitle">Évalue ta performance et améliore-toi pour réussir ton entretien.</p>
          <p class="reassure">
            Répète l'exercice pour progresser !
          </p>
        </div>
        <div class="download-fields">
          <div class="input-group">
            <label for="prenom">Prénom :</label>
            <input type="text" id="prenom" placeholder="Votre prénom" aria-label="Prénom"/>
            <div id="prenom-error" class="error-message"></div>
          </div>
          <div class="input-group">
            <label for="email">Email :</label>
            <input type="email" id="email" placeholder="Votre email" aria-label="Email"/>
            <div id="email-error" class="error-message"></div>
          </div>
        </div>
        <div class="call-to-action">
          <button id="validate-form-btn" aria-label="Valider">
            Valider
          </button>
        </div>
        <div id="success-message" class="success-message" style="display: none;">
          Merci ! Tes ressources sont prêtes.
        </div>
        <div class="download-buttons" id="download-buttons">
          <button id="download-video-btn" aria-label="Télécharger ta vidéo">
            <i class="fas fa-download"></i> Télécharger la vidéo
          </button>
          <button id="download-pdf-btn" aria-label="Télécharger la grille d'analyse">
            <i class="fas fa-download"></i> Télécharger la grille
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bouton de partage LinkedIn (caché sur l'intro) -->
  <button class="linkedin-share-btn" id="linkedin-share-btn" aria-label="Partager sur LinkedIn">
    <i class="fab fa-linkedin-in"></i>
  </button>

  <!-- SCRIPT JavaScript -->
  <script>
    /***********************
     * Gestion des étapes (4 étapes)
     ***********************/
    const boxes = {
      1: document.getElementById('step1'),
      2: document.getElementById('step2'),
      3: document.getElementById('step3'),
      4: document.getElementById('step5')
    };

    const nextBtns = {
      1: document.getElementById('next-btn1'),
      2: document.getElementById('next-btn2'),
      3: document.getElementById('next-btn3')
    };

    const backBtns = {
      2: document.getElementById('back-btn2'),
      3: document.getElementById('back-btn3'),
      4: document.getElementById('back-btn5')
    };

    const introBox = document.getElementById('intro-box');
    const startIntroBtn = document.getElementById('start-intro-btn');
    const topProgressBar = document.getElementById('top-progress-bar');
    const linkedinShareBtn = document.getElementById('linkedin-share-btn');

    // Variables globales
    let currentStepGlobal = 0;
    let currentCategory = null;
    let currentObjective = "";
    let currentSubject = "";

    // Mise à jour de la barre de progression
    function updateProgressBar(step) {
      topProgressBar.style.width = `${(step / 4) * 100}%`;
    }
    updateProgressBar(0);

    // Supprime l'animation "pulse" de tous les boutons Suivant
    function removePulseFromAll() {
      Object.values(nextBtns).forEach(btn => btn.classList.remove('pulse'));
    }

    // Contrôle la visibilité du bouton LinkedIn (caché sur l'intro)
    function updateShareButtonVisibility() {
      linkedinShareBtn.style.display = (currentStepGlobal === 0) ? 'none' : 'flex';
    }

    // Affiche une étape avec animation
    function showBox(current, next) {
      if (!boxes[current] || !boxes[next]) return;
      boxes[current].classList.remove('active', 'slide-from-bottom', 'slide-from-top');
      boxes[next].classList.add('active');
      boxes[next].classList.add((next > current) ? 'slide-from-bottom' : 'slide-from-top');
      updateProgressBar(next);
      currentStepGlobal = next;
      const header = document.querySelector('.header');
      const boxPosition = boxes[next].getBoundingClientRect().top + window.scrollY - (header ? header.offsetHeight : 0) - 20;
      window.scrollTo({ top: boxPosition, behavior: 'smooth' });
      if (next === 2) {
        document.getElementById('selected-objective-display').textContent = explanations[currentCategory] || currentObjective;
      }
      if (next === 3) {
        document.getElementById('current-subject-display').textContent = currentSubject;
      }
      removePulseFromAll();
      updateShareButtonVisibility();
    }

    // Lancement de l'application depuis l'intro
    startIntroBtn.addEventListener('click', () => {
      introBox.style.animation = 'fadeOut 0.5s ease forwards';
      setTimeout(() => {
        introBox.style.display = 'none';
        boxes[1].classList.add('active', 'slide-from-bottom');
        currentStepGlobal = 1;
        updateProgressBar(1);
        removePulseFromAll();
        updateShareButtonVisibility();
      }, 500);
    });

    // Passage de STEP1 à STEP2 (validation de la sélection)
    nextBtns[1].addEventListener('click', () => {
      const selected = document.querySelector('.objectives-container .selected-objective');
      if (!selected) {
        document.getElementById('objective-error').textContent = "Sélectionne un objectif avant de continuer.";
        document.getElementById('objective-error').style.display = 'block';
        return;
      }
      showBox(1, 2);
    });

    // Passage de STEP2 à STEP3 (vérification du sujet généré)
    nextBtns[2].addEventListener('click', () => {
      if (!currentSubject) {
        document.getElementById('subject-error').textContent = "Tu dois générer un sujet avant de continuer.";
        document.getElementById('subject-error').style.display = 'block';
        return;
      }
      showBox(2, 3);
    });

    // Passage de STEP3 à STEP4 (vérification de l'enregistrement)
    nextBtns[3].addEventListener('click', () => {
      const improErrorDiv = document.getElementById('impro-error');
      improErrorDiv.style.display = 'none';
      if (!currentSubject && !improStarted) {
        improErrorDiv.textContent = "Tu dois d'abord générer un sujet et lancer ta simulation.";
        improErrorDiv.style.display = 'block';
        return;
      } else if (currentSubject && !improStarted) {
        improErrorDiv.textContent = "Lance ta simulation avant de continuer.";
        improErrorDiv.style.display = 'block';
        return;
      }
      showBox(3, 4);
    });

    // Boutons "Retour"
    backBtns[2].addEventListener('click', () => { showBox(2, 1); });
    backBtns[3].addEventListener('click', () => { showBox(3, 2); });
    backBtns[4].addEventListener('click', () => { showBox(4, 3); });

    /***********************
     * Gestion des objectifs et explications (STEP1)
     ***********************/
    // Nouvelles descriptions pour chaque objectif
    const explanations = {
      "les-mines": "Grande école d'ingénieurs",
      "sciences-po": "Grande école de sciences politiques",
      "aeronautique": "Formation en aéronautique et aérospatial",
      "polytechnique": "Grande école d'ingénieurs de renom",
      "ens": "École Normale Supérieure",
      "embauche": "Préparation à l'embauche",
      "cpge": "Classes préparatoires aux grandes écoles",
      "hec": "Grande école de commerce"
    };

    // Liens vers les sujets aléatoires pour chaque objectif
    const txtFilesByCategory = {
      "les-mines": "https://github.com/Citizen11bf/letmotiv/blob/84928b67b50f79a5d0b328a3a7e234ce98422787/Entretien_ENS.txt",
      "sciences-po": "https://github.com/Citizen11bf/letmotiv/blob/84928b67b50f79a5d0b328a3a7e234ce98422787/Entretien_Sciences_Po.txt",
      "aeronautique": "https://github.com/Citizen11bf/letmotiv/blob/84928b67b50f79a5d0b328a3a7e234ce98422787/Entretien_SUPAERO.txt",
      "polytechnique": "https://github.com/Citizen11bf/letmotiv/blob/84928b67b50f79a5d0b328a3a7e234ce98422787/Entretien_Polytechnique.txt",
      "ens": "https://github.com/Citizen11bf/letmotiv/blob/84928b67b50f79a5d0b328a3a7e234ce98422787/Entretien_ENS.txt",
      "embauche": "https://github.com/Citizen11bf/letmotiv/blob/84928b67b50f79a5d0b328a3a7e234ce98422787/entretien.txt",
      "cpge": "https://github.com/Citizen11bf/letmotiv/blob/84928b67b50f79a5d0b328a3a7e234ce98422787/Entretien_CPGE.txt",
      "hec": "https://github.com/Citizen11bf/letmotiv/blob/84928b67b50f79a5d0b328a3a7e234ce98422787/Entretien_HEC.txt"
    };

    let subjectsCache = {
      "les-mines": null,
      "sciences-po": null,
      "aeronautique": null,
      "polytechnique": null,
      "ens": null,
      "embauche": null,
      "cpge": null,
      "hec": null
    };

    // Sélection des éléments d'objectif
    const objectivesButtons = document.querySelectorAll('.objectives-container .objective-item');
    const explanationBox = document.getElementById('explanation-box');

    // Gestion de la sélection (réinitialisation des autres, effet d'animation)
    objectivesButtons.forEach(item => {
      item.addEventListener('click', async () => {
        objectivesButtons.forEach(el => {
          el.classList.remove('selected-objective');
          el.style.transform = "";
          el.style.backgroundColor = "";
        });
        item.classList.add('selected-objective');
        currentCategory = item.dataset.category;
        currentObjective = item.innerText;
        item.style.transition = "transform 0.3s, background-color 0.3s";
        item.style.transform = "scale(1.1)";
        item.style.backgroundColor = "rgba(0,164,138,0.2)";
        setTimeout(() => { item.style.transform = ""; }, 300);
        const explication = explanations[currentCategory] || "";
        explanationBox.textContent = explication;
        explanationBox.classList.add('show');
        if (subjectsCache[currentCategory] === null) {
          await loadSubjects(currentCategory);
        }
        document.getElementById('objective-error').style.display = 'none';
        document.getElementById('impro-error').style.display = 'none';
        removePulseFromAll();
        nextBtns[1].classList.add('pulse');
      });
    });

    // Fonction pour charger les sujets depuis le fichier correspondant
    async function loadSubjects(category) {
      const filePath = txtFilesByCategory[category];
      if (!filePath) return [];
      try {
        const response = await fetch(filePath);
        if (!response.ok) {
          console.error("Erreur fetch:", filePath);
          return [];
        }
        const text = await response.text();
        const lines = text.split('\n').map(l => l.trim()).filter(l => l.length > 0);
        subjectsCache[category] = lines;
        return lines;
      } catch (err) {
        console.error("Erreur fetch: ", err);
        return [];
      }
    }

    /***********************
     * Gestion du sujet d'entretien (STEP2)
     ***********************/
    const generateSubjectBtn = document.getElementById('generate-subject-btn');
    const subjectWrapper = document.getElementById('subject-wrapper');
    const subjectDisplay = document.getElementById('subject-display');

    generateSubjectBtn.addEventListener('click', () => {
      if (!currentCategory) {
        document.getElementById('objective-error').textContent = "Sélectionne un objectif avant de générer un sujet.";
        document.getElementById('objective-error').style.display = 'block';
        return;
      }
      const subjects = subjectsCache[currentCategory];
      if (!subjects || subjects.length === 0) {
        subjectDisplay.textContent = "Désolé, aucun sujet n'est disponible pour le moment.";
        subjectWrapper.style.display = 'block';
        currentSubject = "";
        return;
      }
      const randomIndex = Math.floor(Math.random() * subjects.length);
      currentSubject = subjects[randomIndex];
      subjectDisplay.textContent = currentSubject;
      subjectWrapper.style.display = 'block';
      generateSubjectBtn.classList.add('subject-generated');
      document.getElementById('subject-error').style.display = 'none';
      removePulseFromAll();
      nextBtns[2].classList.add('pulse');
    });

    /***********************
     * Enregistrement vidéo (STEP3)
     ***********************/
    let improStarted = false;
    let mediaRecorderInstance;
    let recordedChunks = [];
    const preview = document.getElementById('preview');
    const stopBtn = document.getElementById('stop-btn');
    const restartBtn = document.getElementById('restart-btn');
    const recordingIndicator = document.getElementById('recording-indicator');
    const countdownElement = document.getElementById('countdown');
    const initialCountdownOverlay = document.getElementById('initial-countdown-overlay');
    const initialCountdown = document.getElementById('initial-countdown');

    let countdown, videoURL = "", timerInterval, timeRemaining = 120;

    function bindStartButton() {
      const startBtn = document.getElementById('start-btn');
      if (startBtn) { startBtn.addEventListener('click', startImpro); }
    }

    async function startImpro() {
      if (!currentSubject) {
        document.getElementById('impro-error').textContent = "Génère un sujet avant de démarrer la simulation.";
        document.getElementById('impro-error').style.display = 'block';
        return;
      }
      if (typeof MediaRecorder === 'undefined' || !navigator.mediaDevices?.getUserMedia) {
        document.getElementById('impro-error').textContent = "Votre navigateur ne supporte pas l'enregistrement vidéo.";
        document.getElementById('impro-error').style.display = 'block';
        return;
      }
      if (!confirm("Votre webcam va se lancer pour la simulation. Continuer ?")) { return; }
      if (window.innerWidth <= 600) {
        const videoBox = document.querySelector('.video-box');
        videoBox.style.height = "450px";
        const subjectElem = document.getElementById('current-subject-display');
        if (subjectElem) {
          const subjectTop = subjectElem.getBoundingClientRect().top + window.pageYOffset;
          window.scrollTo({ top: subjectTop - 60, behavior: 'smooth' });
        }
      }
      document.querySelector('.video-overlay').style.display = 'none';
      startInitialCountdown();
    }

    function startInitialCountdown() {
      let count = 5;
      initialCountdown.textContent = count;
      initialCountdownOverlay.style.display = 'flex';
      countdown = setInterval(() => {
        count--;
        if (count > 0) { initialCountdown.textContent = count; }
        else { clearInterval(countdown); initialCountdownOverlay.style.display = 'none'; initiateRecording(); }
      }, 1000);
    }

    async function initiateRecording() {
      const stream = await setupCamera();
      if (!stream) return;
      if (!window.MediaRecorder || typeof MediaRecorder.isTypeSupported === 'undefined') {
        document.getElementById('impro-error').textContent = "Votre navigateur ne supporte pas l'enregistrement vidéo.";
        document.getElementById('impro-error').style.display = 'block';
        return;
      }
      mediaRecorderInstance = new MediaRecorder(stream);
      recordedChunks = [];
      mediaRecorderInstance.ondataavailable = event => { if (event.data.size > 0) { recordedChunks.push(event.data); } };
      mediaRecorderInstance.onstop = () => {
        const videoBlob = new Blob(recordedChunks, { type: 'video/mp4' });
        videoURL = URL.createObjectURL(videoBlob);
        stream.getTracks().forEach(t => t.stop());
        const overlay = document.querySelector('.video-overlay');
        overlay.innerHTML = "<p style='color: white; font-size: 18px; text-align: center;'>Simulation terminée. Passe à l'étape suivante !</p>";
        overlay.style.display = 'flex';
        document.getElementById('impro-error').style.display = 'none';
        recordingIndicator.style.display = 'none';
        clearInterval(timerInterval);
        improStarted = true;
        removePulseFromAll();
        nextBtns[3].classList.add('pulse');
        if (window.innerWidth <= 600) { document.querySelector('.video-box').style.height = "300px"; }
      };
      mediaRecorderInstance.start();
      recordingIndicator.style.display = 'flex';
      stopBtn.classList.remove('hidden-btn');
      stopBtn.disabled = false;
      restartBtn.classList.add('hidden-btn');
      startTimer();
    }

    async function setupCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
        preview.srcObject = stream;
        return stream;
      } catch (error) {
        const improErrorDiv = document.getElementById('impro-error');
        if (error.name === 'NotAllowedError') { improErrorDiv.textContent = "Accès à la webcam refusé."; }
        else if (error.name === 'NotFoundError') { improErrorDiv.textContent = "Aucune caméra/micro détecté."; }
        else { improErrorDiv.textContent = "Erreur : Impossible d'accéder à la webcam."; }
        improErrorDiv.style.display = 'block';
        console.error(error);
        return null;
      }
    }

    function startTimer() {
      timeRemaining = 120;
      updateCountdownDisplay();
      timerInterval = setInterval(() => {
        timeRemaining--;
        if (timeRemaining >= 0) { updateCountdownDisplay(); }
        if (timeRemaining < 0) {
          clearInterval(timerInterval);
          if (mediaRecorderInstance && mediaRecorderInstance.state === 'recording') {
            mediaRecorderInstance.stop();
            restartBtn.classList.remove('hidden-btn');
          }
        }
      }, 1000);
    }
    function updateCountdownDisplay() {
      const minutes = Math.floor(timeRemaining / 60);
      const seconds = timeRemaining % 60;
      countdownElement.textContent = `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
      countdownElement.style.display = 'block';
    }

    stopBtn.addEventListener('click', () => {
      if (mediaRecorderInstance && mediaRecorderInstance.state === 'recording') {
        mediaRecorderInstance.stop();
        clearInterval(countdown);
        clearInterval(timerInterval);
        stopBtn.classList.add('hidden-btn');
        stopBtn.disabled = true;
        restartBtn.classList.remove('hidden-btn');
        recordingIndicator.style.display = 'none';
      }
    });
    restartBtn.addEventListener('click', () => {
      restartBtn.classList.add('hidden-btn');
      document.querySelector('.video-overlay').innerHTML = `
        <p>Ici, ta simulation va s'enregistrer. Clique pour démarrer.</p>
        <button id="start-btn" aria-label="Démarrer la simulation">
          Démarrer <i class="fas fa-video"></i>
        </button>
        <p>NB : La vidéo reste sur ton appareil.</p>
      `;
      document.querySelector('.video-overlay').style.display = 'flex';
      improStarted = false;
      bindStartButton();
    });
    bindStartButton();

    /***********************
     * Téléchargements et Google Forms (STEP4)
     ***********************/
    const validateFormBtn = document.getElementById('validate-form-btn');
    const prenomInput = document.getElementById('prenom');
    const emailInput = document.getElementById('email');
    const prenomError = document.getElementById('prenom-error');
    const emailError = document.getElementById('email-error');
    const downloadButtons = document.getElementById('download-buttons');
    const downloadVideoBtn = document.getElementById('download-video-btn');
    const downloadPdfBtn = document.getElementById('download-pdf-btn');

    validateFormBtn.addEventListener('click', () => {
      const prenomValue = prenomInput.value.trim();
      const emailValue = emailInput.value.trim();
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      const prenomRegex = /^[A-Za-zÀ-ÿ '-]+$/;
      let valid = true;
      prenomError.style.display = 'none';
      emailError.style.display = 'none';
      if (!prenomValue || !prenomRegex.test(prenomValue)) {
        prenomError.textContent = "Entre un prénom valide.";
        prenomError.style.display = 'block';
        valid = false;
      }
      if (!emailValue) {
        emailError.textContent = "Merci de renseigner ton email.";
        emailError.style.display = 'block';
        valid = false;
      } else if (!emailRegex.test(emailValue)) {
        emailError.textContent = "Entre une adresse email valide.";
        emailError.style.display = 'block';
        valid = false;
      }
      if (!valid) return;
      document.getElementById('hidden-prenom').value = prenomValue;
      document.getElementById('hidden-email').value = emailValue;
      document.getElementById('hidden-google-form').submit();
      const successMessage = document.getElementById('success-message');
      successMessage.style.display = 'block';
      successMessage.classList.add('show');
      setTimeout(() => { successMessage.classList.remove('show'); successMessage.style.display = 'none'; }, 5000);
      if (videoURL) {
        const link = document.createElement('a');
        link.href = videoURL;
        link.download = 'Entretien_Simulation.mp4';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
      setTimeout(() => { window.location.href = "https://www.letmotiv.fr/simulateur-entretiens/feedback"; }, 1000);
    });

    /***********************
     * Gestion du swipe sur mobile avec Hammer.js
     ***********************/
    const mainContainer = document.querySelector('.main-container');
    const hammer = new Hammer(mainContainer);
    hammer.get('swipe').set({ direction: Hammer.DIRECTION_VERTICAL });
    hammer.on('swipeup', function(ev) { if (nextBtns[currentStepGlobal]) { nextBtns[currentStepGlobal].click(); } });
    hammer.on('swipedown', function(ev) { if (currentStepGlobal > 1 && backBtns[currentStepGlobal]) { backBtns[currentStepGlobal].click(); } });

    /***********************
     * Bouton de partage LinkedIn
     ***********************/
    document.getElementById("linkedin-share-btn").addEventListener("click", () => {
      const shareURL = encodeURIComponent(window.location.href);
      const shareText = encodeURIComponent("Je prépare mon entretien avec ce simulateur !");
      const linkedInURL = `https://www.linkedin.com/sharing/share-offsite/?url=${shareURL}&summary=${shareText}`;
      window.open(linkedInURL, '_blank');
    });
  </script>
</body>
</html>
