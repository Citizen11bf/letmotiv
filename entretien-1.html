<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Letmotiv - Simulateur d'entretien</title>
  <meta name="description" content="Prépare-toi aux entretiens d'embauche et d'admission grâce au simulateur d'entretien Letmotiv.">

  <!-- Icône de la page (favicon) -->
  <link rel="icon" href="https://raw.githubusercontent.com/Citizen11bf/letmotiv/refs/heads/images/Letmotiv_favicon.webp" type="image/png">
  <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/Citizen11bf/letmotiv/refs/heads/images/Letmotiv_favicon.webp">
  
  <!-- Balises Open Graph pour LinkedIn -->
  <meta property="og:title" content="Letmotiv - Simulateur d'entretien" />
  <meta property="og:description" content="Prépare-toi aux entretiens d'embauche et d'admission grâce au simulateur d'entretien Letmotiv." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://letmotiv-simulateur.fr" />
  <meta property="og:image" content="https://i.postimg.cc/qvxsxJR3/Simulateur-interview.png" />
  <meta property="og:image:alt" content="Illustration d'un entretien de simulation." />
  <meta name="author" content="Simulateur d'entretien Letmotiv" />
  <meta property="article:published_time" content="2025-01-26" />

  <!-- Balises Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Letmotiv - Simulateur d'entretien">
  <meta name="twitter:description" content="Prépare-toi aux entretiens d'embauche et d'admission grâce au simulateur d'entretien Letmotiv.">
  <meta name="twitter:image" content="https://i.postimg.cc/qvxsxJR3/Simulateur-interview.png">

  <!-- Import de la police DM Sans et Montserrat depuis Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans&family=Montserrat:wght@700&display=swap" rel="stylesheet" />

  <!-- Icônes Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  
  <!-- Inclusion de Hammer.js pour la gestion des gestes sur mobile -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Letmotiv - Simulateur d'entretien",
      "url": "https://letmotiv-simulateur.fr/entretien",
      "description": "Prépare-toi aux entretiens d'embauche et d'admission grâce au simulateur d'entretien Letmotiv.",
      "publisher": {
        "@type": "Organization",
        "name": "Letmotiv",
        "logo": "https://letmotiv-simulateur.fr/logo.png"
      }
    }
  </script>
  
  <style>
    /* --- GLOBAL --- */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'DM Sans', sans-serif;
      background-color: #ffffff;
      color: #333333;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
      padding-top: 60px;
      padding-bottom: 20px;
    }

    /* Messages d'erreur en rouge et en gras */
    .error-message {
      color: red;
      font-weight: bold;
    }

    /* --- HEADER --- */
    .header {
      background-color: #182d84;
      color: #FFFFFF;
      font-size: 16px;
      font-weight: bold;
      text-align: center;
      padding: 10px;
      width: 100%;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 10;
    }
    .header-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 5px;
      max-width: 100%;
      overflow-wrap: break-word;
    }
    .header-l2 { font-size: 14px; font-weight: normal; }

    /* --- BARRE DE PROGRESSION --- */
    .progress-container {
      position: fixed;
      top: 60px;
      left: 0;
      width: 100%;
      height: 8px;
      background-color: rgba(24, 45, 132, 0.1);
      z-index: 9;
    }
    .progress-bar {
      width: 0%;
      height: 100%;
      background-color: #00a48a;
      transition: width 0.5s ease;
    }

    @media (max-width: 600px) {
      /* Réduire l'espace sous le header et les marges des box sur mobile */
      body { padding-top: 40px; }
      .box { margin: 10px 0; }
      /* Rapprocher les boutons dans .impro-actions */
      .impro-actions { gap: 5px; }
    }

    @media (max-width: 600px) {
      h1 .line {
        display: block;
      }
    }
    
    /* --- BOÎTE D'INTRODUCTION --- */
    .intro-box {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #2E22AC, #E34C9D);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #ffffff;
      z-index: 20;
      animation: fadeIn 1s ease forwards;
    }
    .intro-box h1 {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.5rem;
      margin-bottom: 30px;
      animation: slideDown 1s ease forwards;
    }
    .intro-box button {
      background-color: #ffffff;
      color: #182d84;
      font-family: 'DM Sans', sans-serif;
      font-size: 1.2rem;
      border: none;
      border-radius: 25px;
      padding: 15px 30px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.3s, color 0.3s;
      box-shadow: 0px 4px 6px rgba(0,0,0,0.2);
    }
    .intro-box button:hover {
      background-color: #00a48a;
      color: #ffffff;
      transform: scale(1.05);
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
    @keyframes slideDown { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    /* --- CONTENEUR PRINCIPAL --- */
    .main-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex-grow: 1;
      width: 100%;
      padding: 20px;
    }

    /* --- BOXES (étapes) --- */
    .box {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: 20px 0;
      padding: 20px;
      border-radius: 15px;
      background: linear-gradient(135deg, #ffffff, #f9f9f9);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
      font-size: 14px;
      display: none;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .box.active { display: block; }
    .box:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    }

    /* --- ANIMATIONS VERTICALES --- */
    .slide-from-bottom { animation: fromBottom 1.5s ease forwards; }
    @keyframes fromBottom { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
    .slide-from-top { animation: fromTop 1.5s ease forwards; }
    @keyframes fromTop { from { opacity: 0; transform: translateY(-50px); } to { opacity: 1; transform: translateY(0); } }

    /* --- HEADER INTERNE DES BOXES --- */
    .box-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      position: relative;
    }
    .back-btn {
      border: none;
      background-color: #808080;
      color: #FFFFFF;
      font-size: 16px;
      cursor: pointer;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s, transform 0.3s;
      margin: 0 auto;
      margin-bottom: 10px;
    }
    .back-btn:hover { background-color: #505050; transform: scale(1.1); }
    .back-btn:active { background-color: #303030; }
    #step1 .back-btn.hidden-visibility { display: none; }
    .box-title { font-size: 18px; font-weight: bold; color: #182d84; text-align: center; }

    /* --- FLECHES HAUT/BAS --- */
    .next-btn, .back-btn { }
    .next-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #182d84;
      background-color: transparent;
      color: #182d84;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s, transform 0.3s;
      margin: 10px auto;
    }
    .next-btn:hover { background-color: #00a48a; color: #ffffff; transform: scale(1.05); }
    .next-btn.pulse { animation: electricPulse 1.5s infinite; }
    @keyframes electricPulse {
      0% { box-shadow: 0 0 0 0 rgba(0,164,138,0.7); }
      70% { box-shadow: 0 0 0 10px rgba(0,164,138,0); }
      100% { box-shadow: 0 0 0 0 rgba(0,164,138,0); }
    }

    /* --- Bouton de style pour "Démarrer ton entretien" et boutons similaires --- */
    .btn-impro {
      pointer-events: auto;
      margin: 15px 0;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .btn-impro:hover { background-color: #00a48a; }

    /* --- STEP1 : Choix d’objectif avec effet "Carte Flip" --- */
    .objectives-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      justify-items: center;
      margin: 10px 0;
    }
    @media (max-width: 600px) {
      .objectives-container { grid-template-columns: repeat(2, 1fr); }
      .flip-card { width: 90px; height: 100px; }
      .flip-card-front i { font-size: 1.8rem; }
      .flip-card-front span { font-size: 0.9rem; }
    }
    @media (max-width: 550px) {
      .flip-card { max-width: 120px; height: 90px; }
      .flip-card-front i { font-size: 1.5rem; }
      .flip-card-front span { font-size: 0.7rem; }
    }
    .flip-card {
      background-color: transparent;
      width: 100%;
      max-width: 150px;
      height: 120px;
      perspective: 1000px;
      cursor: pointer;
    }
    .flip-card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      border-radius: 8px;
      background-color: #fff;
    }
    .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
    .flip-card-front,
    .flip-card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px;
      transition: background-color 0.3s, color 0.3s;
    }
    .flip-card-front {
      background: #fff;
      color: #808080;
      border: 1px solid #ccc;
    }
    .flip-card-front i { font-size: 1.8rem; margin-bottom: 8px; }
    .flip-card-front span { font-size: 0.9rem; font-weight: bold; }
    .flip-card-back {
      background: #f0f0f0;
      color: #00a48a;
      transform: rotateY(180deg);
      font-size: 0.8rem;
      padding: 8px;
      text-align: center;
      border: 1px solid #ccc;
    }

    /* --- STEP2 : Configuration de la simulation --- */
    .simulation-instructions {
      padding: 20px;
      font-size: 16px;
      text-align: center;
    }
    .simulation-buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .simulation-buttons button:hover {
      transform: scale(1.05);
    }
    .simulation-buttons button:active {
      transform: scale(0.95);
    }
    .simulation-buttons button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .simulation-buttons button.selected {
      background-color: #00a48a;
      color: #fff;
    }

    /* --- STEP3 : Enregistrement vidéo --- */
    .video-box {
      margin: 10px auto;
      border: 3px solid #182d84;
      border-radius: 6px;
      max-width: 500px;
      background-color: #fefefe;
      height: 300px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      transition: height 0.5s ease-in-out;
    }
    .video-box video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 4px;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
      transform: scaleX(-1);
      -webkit-transform: scaleX(-1);
    }
    /* L'overlay pour les questions sera positionné en haut (sans la classe centered) */
    .video-overlay {
      position: absolute;
      z-index: 2;
      top: 0;
      left: 0;
      width: 100%;
      padding: 5px;
      display: flex;
      flex-direction: column;
      /* Par défaut, aligné en haut pour les questions */
      justify-content: flex-start;
      align-items: center;
      text-align: center;
      color: #555;
      font-style: italic;
      font-size: 13px;
      background: rgba(255,255,255,0.6);
    }
    /* Pour l'affichage initial et final, on ajoute la classe "centered" */
    .video-overlay.centered {
      height: 100%;
      justify-content: center;
      align-items: center;
    }
    .video-overlay p { margin: 10px 0; }
    .video-overlay button {
      pointer-events: auto;
      margin: 15px 0;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .video-overlay button:hover { background-color: #00a48a; }
    /* Indicateur d'enregistrement repositionné en bas à gauche avec espace entre l'icône et le texte */
    .recording-indicator {
      position: absolute;
      bottom: 10px;
      left: 10px;
      display: flex;
      align-items: center;
      background-color: rgba(255,255,255,0.8);
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 14px;
      color: #ff0000;
      display: none;
      z-index: 3;
    }
    .recording-indicator i { margin-right: 5px; }
    /* Chrono */
    .countdown {
      position: absolute;
      bottom: 10px;
      right: 10px;
      font-size: 18px;
      color: #ffffff;
      display: none;
      z-index: 4;
      background-color: rgba(0,0,0,0.5);
      padding: 5px 10px;
      border-radius: 5px;
      text-align: center;
    }
    .initial-countdown-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(128,128,128,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 5;
      border-radius: 6px;
    }
    .initial-countdown {
      font-size: 48px;
      color: #ffffff;
      font-weight: bold;
    }

    .impro-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 10px;
    }
    .hidden-btn { display: none; }

    /* --- STEP4 : Analyse ta prestation & Téléchargements --- */
    .download-section { margin-top: 20px; }
    .download-section-accent {
      background: linear-gradient(135deg, #182d84, #00a48a);
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      color: #fff;
      margin-bottom: 20px;
      animation: fadeInDown 0.6s ease forwards;
    }
    .download-section-accent h2 {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.5rem;
      margin: 0 0 10px;
    }
    .download-section-accent .subtitle { font-style: italic; margin-bottom: 10px; }
    .download-section-accent .reassure { font-size: 0.9rem; opacity: 0.9; }
    .call-to-action { text-align: center; }
    .call-to-action button {
      background-color: #ffcb2d;
      color: #000;
      border-radius: 30px;
      padding: 12px 24px;
      font-weight: bold;
      font-size: 1rem;
      transition: transform 0.2s, box-shadow 0.2s;
      margin: 10px auto;
    }
    .call-to-action button:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    /* Boutons STEP4 dans le même design que les autres */
    #step4-extra {
      display: none;
      margin-top: 20px;
    }
    #step4-extra button {
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin: 5px;
      transition: background-color 0.3s;
    }
    #step4-extra button:hover {
      background-color: #00a48a;
    }
    @keyframes fadeInDown { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    
    /* --- Styles pour le bouton de partage LinkedIn --- */
    #linkedin-share {
      position: fixed;
      bottom: 15px;
      right: 15px;
      background-color: #0077B5;
      color: #fff;
      font-size: 14px;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
      transition: background-color 0.3s, transform 0.2s;
      z-index: 100;
    }
   
    #linkedin-share a {
      font-size: 18px;
    }
    
  </style>
</head>
<body>
  <!-- Élément audio pour le feedback sonore (pop léger) -->
  <audio id="pop-sound" src="https://www.soundjay.com/button/sounds/button-30.mp3"></audio>

  <!-- BOÎTE D'INTRODUCTION -->
  <div class="intro-box" id="intro-box">
    <h1>
      <span class="line">Entraîne-toi</span>
      <span class="line">pour réussir</span>
      <span class="line">ton entretien</span>
    </h1>
    <button id="start-intro-btn" aria-label="Commencer">Commencer</button>
  </div>
  
  <!-- HEADER -->
  <div class="header">
    <div class="header-content">
      <div class="header-l1">Simulateur d'entretien</div>
      <div class="header-l2">Letmotiv - Coaching en prise de parole</div>
    </div>
  </div>

  <!-- BARRE DE PROGRESSION -->
  <div class="progress-container">
    <div class="progress-bar" id="top-progress-bar"></div>
  </div>

  <!-- CONTAINER PRINCIPAL -->
  <div class="main-container">
    <!-- STEP1 : Choix d'objectif -->
    <div class="box" id="step1">
      <div class="box-header">
        <button class="back-btn hidden-visibility" id="back-btn1" aria-label="Retour">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Quel entretien souhaites-tu préparer ?</div>
      </div>
      <div class="objectives-container">
        <!-- Grand Oral -->
        <div class="flip-card objective-item" data-category="grand-oral">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <i class="fas fa-microphone"></i>
              <span>Grand Oral</span>
            </div>
            <div class="flip-card-back">
              Prépare-toi pour le Grand Oral.
            </div>
          </div>
        </div>
        <!-- Ecole d'ingénieur généraliste -->
        <div class="flip-card objective-item" data-category="ingenieur-generaliste">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <i class="fas fa-cogs"></i>
              <span>Ecole d'ingénieur généraliste</span>
            </div>
            <div class="flip-card-back">
              Prépare ton entretien pour une école d'ingénieur généraliste.
            </div>
          </div>
        </div>
        <!-- Ecole d'ingénieur aéro -->
        <div class="flip-card objective-item" data-category="ingenieur-aero">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <i class="fas fa-rocket"></i>
              <span>Ecole d'ingénieur aéro</span>
            </div>
            <div class="flip-card-back">
              Prépare ton entretien pour une école d'ingénieur spécialisée en aéronautique.
            </div>
          </div>
        </div>
        <!-- Ecole de commerce -->
        <div class="flip-card objective-item" data-category="commerce">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <i class="fas fa-handshake"></i>
              <span>Ecole de commerce</span>
            </div>
            <div class="flip-card-back">
              Prépare ton entretien pour une école de commerce.
            </div>
          </div>
        </div>
        <!-- Ecole de Sciences Politiques -->
        <div class="flip-card objective-item" data-category="sciences-politiques">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <i class="fas fa-university"></i>
              <span>Ecole de Sciences Politiques</span>
            </div>
            <div class="flip-card-back">
              Prépare ton entretien pour une école de Sciences Politiques.
            </div>
          </div>
        </div>
        <!-- Entretien d'embauche -->
        <div class="flip-card objective-item" data-category="embauche">
          <div class="flip-card-inner">
            <div class="flip-card-front">
              <i class="fas fa-briefcase"></i>
              <span>Entretien d'embauche</span>
            </div>
            <div class="flip-card-back">
              Prépare-toi pour ton entretien d'embauche.
            </div>
          </div>
        </div>
      </div>
      <div id="objective-error" class="error-message"></div>
      <button class="next-btn" id="next-btn1" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP2 : Configuration de la simulation -->
    <div class="box" id="step2">
      <div class="box-header step2-header">
        <button class="back-btn" id="back-btn2" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Configuration de la simulation</div>
      </div>
      <div class="simulation-instructions">
        Tu vas réaliser une simulation d'entretien. <br>Tu as 2 minutes pour répondre par question.<br><br>
        Choisis le nombre de questions que tu souhaites simuler : 
      </div>
      <div class="simulation-buttons">
        <button class="btn-impro" data-question-count="3">3</button>
        <button class="btn-impro" data-question-count="4">4</button>
        <button class="btn-impro" data-question-count="5">5</button>
      </div>
      <div id="subject-error" class="error-message"></div>
      <button class="next-btn" id="next-btn2" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP3 : Enregistrement vidéo -->
    <div class="box" id="step3">
      <div class="box-header">
        <button class="back-btn" id="back-btn3" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Lance ton entretien</div>
      </div>
      <div class="video-box">
        <video id="preview" autoplay muted playsinline webkit-playsinline></video>
        <!-- Overlay utilisée pour le contenu initial et final (centré) ou pour les questions (non centré) -->
        <div class="video-overlay centered" id="question-overlay">
          <p style="font-size:16px; text-align:center;">
            Ici va s'enregistrer ton entretien vidéo.<br>
            Lorsque tu es prêt, clique sur le bouton ci-dessous.
          </p>
          <button id="start-btn" aria-label="Démarrer l'entretien">
            Démarrer ton entretien <i class="fas fa-video"></i>
          </button>
          <p style="font-size:12px;">NB : ta vidéo est stockée sur ton appareil. <br>Aucun enregistrement n'est conservé par Letmotiv.</p>
        </div>
        <!-- Indicateur d'enregistrement repositionné en bas à gauche -->
        <div class="recording-indicator" id="recording-indicator">
          <i class="fas fa-record-vinyl"></i> Enregistrement en cours
        </div>
        <!-- Décompte en bas à droite -->
        <div class="countdown" id="countdown">2:00</div>
        <div class="initial-countdown-overlay" id="initial-countdown-overlay">
          <div class="initial-countdown" id="initial-countdown">5</div>
        </div>
      </div>
      <div class="impro-actions">
        <button id="next-question-btn" class="hidden-btn btn-impro" aria-label="Question suivante">
          Question suivante <i class="fas fa-forward"></i>
        </button>
        <button id="stop-btn" class="hidden-btn btn-impro" aria-label="Arrêter l'entretien">
          Arrêter ton entretien <i class="fas fa-stop"></i>
        </button>
        <button id="restart-btn" class="hidden-btn btn-impro" aria-label="Recommencer l'entretien">
          Recommencer ton entretien <i class="fas fa-redo"></i>
        </button>
      </div>
      <!-- Zone pour les messages d'erreur du STEP3 -->
      <div id="impro-error" class="error-message"></div>
      <button class="next-btn" id="next-btn3" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP4 : Analyse ta prestation & Téléchargements -->
    <div class="box" id="step4">
      <div class="box-header">
        <button class="back-btn" id="back-btn5" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Analyse ton entretien</div>
      </div>
      <div class="download-section">
        <div class="download-section-accent">
          <h2>Obtiens gratuitement ta prestation en vidéo et des éléments d'analyse Letmotiv</h2>
          <p class="reassure">
            N'hésite pas à t'entraîner et refaire des simulations pour progresser.
          </p>
        </div>
        <div class="call-to-action">
          <button id="validate-form-btn" aria-label="Télécharger ma vidéo">
            Télécharger ma vidéo
          </button>
        </div>
        <div id="step4-extra">
          <button id="redo-btn">Refaire une simulation d'entretien</button>
          <button id="resources-btn">Accéder aux ressources Letmotiv</button>
        </div>
      </div>
    </div>

  </div>

  <!-- Bouton de partage LinkedIn (affiché à partir du STEP1) -->
  <div id="linkedin-share">
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://letmotiv-simulateur.fr&title=Letmotiv%20-%20Simulateur%20d'entretien" target="_blank" title="Partager sur LinkedIn">
      <i class="fab fa-linkedin"></i>
    </a>
  </div>

  <!-- SCRIPT -->
  <script>
    /***********************
     * Gestion des étapes (4 étapes)
     ***********************/
    const boxes = {
      1: document.getElementById('step1'),
      2: document.getElementById('step2'),
      3: document.getElementById('step3'),
      4: document.getElementById('step4')
    };

    const nextBtns = {
      1: document.getElementById('next-btn1'),
      2: document.getElementById('next-btn2'),
      3: document.getElementById('next-btn3')
    };

    const backBtns = {
      2: document.getElementById('back-btn2'),
      3: document.getElementById('back-btn3'),
      4: document.getElementById('back-btn5')
    };

    const introBox = document.getElementById('intro-box');
    const startIntroBtn = document.getElementById('start-intro-btn');
    const topProgressBar = document.getElementById('top-progress-bar');

    let currentStepGlobal = 0;
    let currentCategory = null;
    let selectedQuestionCount = 0;
    let currentQuestionIndex = 1; // Pour "Question X/Y :"
    let improStarted = false; // Indique si l'entretien a démarré

    // Objet de correspondance pour l'affichage dans STEP1
    const objectiveDisplayMapping = {
      "grand-oral": "passer le Grand Oral du BAC",
      "ingenieur-generaliste": "intégrer une école d'ingénieur généraliste",
      "ingenieur-aero": "intégrer une école d'ingénieur aéro",
      "commerce": "intégrer une école de commerce",
      "sciences-politiques": "intégrer une école de Sciences Politiques",
      "embauche": "réussir ton entretien d'embauche"
    };

    function updateProgressBar(step) {
      const progress = (step / 4) * 100;
      topProgressBar.style.width = `${progress}%`;
    }
    updateProgressBar(0);

    function removePulseFromAll() {
      Object.values(nextBtns).forEach(btn => btn.classList.remove('pulse'));
    }

    function showBox(current, next) {
      if (!boxes[current] || !boxes[next]) return;
      boxes[current].classList.remove('active', 'slide-from-bottom', 'slide-from-top');
      boxes[next].classList.add('active');
      if (next > current) {
        boxes[next].classList.add('slide-from-bottom');
      } else {
        boxes[next].classList.add('slide-from-top');
      }
      updateProgressBar(next);
      currentStepGlobal = next;
      removePulseFromAll();

      // Gestion de l'affichage du bouton LinkedIn :
      const linkedinBtn = document.getElementById('linkedin-share');
      if (next >= 1) {
        linkedinBtn.style.display = 'flex';
      } else {
        linkedinBtn.style.display = 'none';
      }
    }

    startIntroBtn.addEventListener('click', () => {
      introBox.style.animation = 'fadeOut 0.5s ease forwards';
      setTimeout(() => {
        introBox.style.display = 'none';
        boxes[1].classList.add('active', 'slide-from-bottom');
        currentStepGlobal = 1;
        updateProgressBar(1);
        removePulseFromAll();
      }, 500);
    });

    nextBtns[1].addEventListener('click', () => {
      const selected = document.querySelector('.objectives-container .flip-card.flipped');
      if (!selected) {
        const errorDiv = document.getElementById('objective-error');
        errorDiv.textContent = "Sélectionne un objectif avant de continuer.";
        errorDiv.style.display = 'block';
        return;
      }
      showBox(1, 2);
    });

    nextBtns[2].addEventListener('click', () => {
      if (selectedQuestionCount === 0) {
        const subjErrorDiv = document.getElementById('subject-error');
        subjErrorDiv.textContent = "Choisis le nombre de questions avant de continuer.";
        subjErrorDiv.style.display = 'block';
        return;
      }
      showBox(2, 3);
    });

    // Vérification pour STEP3 : on ne passe à STEP4 que si l'entretien a démarré
    nextBtns[3].addEventListener('click', () => {
      if (!improStarted) {
        const improErrorDiv = document.getElementById('impro-error');
        improErrorDiv.textContent = "Tu dois démarrer l'entretien avant de passer à l'étape suivante.";
        improErrorDiv.style.display = 'block';
        return;
      }
      showBox(3, 4);
    });

    backBtns[2].addEventListener('click', () => { showBox(2, 1); });
    backBtns[3].addEventListener('click', () => { showBox(3, 2); });
    backBtns[4].addEventListener('click', () => { showBox(4, 3); });

    /***********************
     * Gestion des objectifs (STEP1) et feedback sonore
     ***********************/
    const objectivesCards = document.querySelectorAll('.objectives-container .objective-item');
    const popSound = document.getElementById('pop-sound');

    objectivesCards.forEach(card => {
      card.addEventListener('click', async () => {
        popSound.currentTime = 0;
        popSound.play();

        objectivesCards.forEach(c => c.classList.remove('flipped'));
        card.classList.add('flipped');
        currentCategory = card.dataset.category;
        document.getElementById('objective-error').style.display = 'none';
      });
    });

    /***********************
     * Choix du nombre de questions (STEP2)
     ***********************/
    document.querySelectorAll('.simulation-buttons button').forEach(btn => {
      btn.addEventListener('click', () => {
        selectedQuestionCount = parseInt(btn.getAttribute('data-question-count'));
        document.querySelectorAll('.simulation-buttons button').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        document.getElementById('subject-error').style.display = 'none';
      });
    });

    /***********************
     * Fonction loadSubjects pour charger les questions depuis un fichier texte
     ***********************/
    async function loadSubjects(category) {
      const txtFilesByCategory = {
        "grand-oral": "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/Grand_Oral.txt",
        "ingenieur-generaliste": "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/Entretien_Les_Mines.txt",
        "ingenieur-aero": "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/Entretien_SUPAERO.txt",
        "commerce": "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/Entretien_HEC.txt",
        "sciences-politiques": "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/Entretien_Sciences_Po.txt",
        "embauche": "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/entretien.txt"
      };
      const filePath = txtFilesByCategory[category];
      if (!filePath) return [];
      try {
        const response = await fetch(filePath);
        if (!response.ok) {
          console.error("Erreur fetch:", filePath);
          return [];
        }
        const text = await response.text();
        const lines = text.split('\n').map(l => l.trim()).filter(l => l.length > 0);
        return lines;
      } catch (err) {
        console.error("Erreur fetch: ", err);
        return [];
      }
    }

    /***********************
     * Enregistrement vidéo (STEP3) et gestion des questions
     ***********************/
    let mediaRecorderInstance;
    let recordedChunks = [];
    const preview = document.getElementById('preview');
    const stopBtn = document.getElementById('stop-btn');
    const restartBtn = document.getElementById('restart-btn');
    const nextQuestionBtn = document.getElementById('next-question-btn');
    const recordingIndicator = document.getElementById('recording-indicator');
    const countdownElement = document.getElementById('countdown');
    const initialCountdownOverlay = document.getElementById('initial-countdown-overlay');
    const initialCountdown = document.getElementById('initial-countdown');
    const questionOverlay = document.getElementById('question-overlay');

    let timerInterval;
    let videoURL = "";

    // Fonction pour démarrer l'entretien
    function bindStartButton() {
      const startBtn = document.getElementById('start-btn');
      if(startBtn){
        startBtn.addEventListener('click', startImpro);
      }
    }

    async function startImpro() {
      if (selectedQuestionCount === 0) {
        const improErrorDiv = document.getElementById('impro-error');
        improErrorDiv.textContent = "Choisis d'abord le nombre de questions en étape 2.";
        improErrorDiv.style.display = 'block';
        return;
      }
      if (typeof MediaRecorder === 'undefined' || !navigator.mediaDevices?.getUserMedia) {
        const improErrorDiv = document.getElementById('impro-error');
        improErrorDiv.textContent = "L'enregistrement vidéo n'est pas supporté par votre navigateur.";
        improErrorDiv.style.display = 'block';
        return;
      }
      if (!confirm("Votre webcam va se lancer pour démarrer l'entretien. Voulez-vous continuer ?")) {
        return;
      }
      if (window.innerWidth <= 600) {
          const videoBox = document.querySelector('.video-box');
          videoBox.style.height = "450px";
      }
      // Pour le contenu initial, on ajoute la classe "centered"
      questionOverlay.classList.add('centered');
      questionOverlay.style.display = 'none';
      startInitialCountdown();
    }

    function startInitialCountdown() {
      let count = 5;
      initialCountdown.textContent = count;
      initialCountdownOverlay.style.display = 'flex';
      const initCountdown = setInterval(() => {
        count--;
        if (count > 0) {
          initialCountdown.textContent = count;
        } else {
          clearInterval(initCountdown);
          initialCountdownOverlay.style.display = 'none';
          initiateRecording();
        }
      }, 1000);
    }

    // Affiche la question avec le préfixe "Question X/Y :"
    // Pour l'affichage des questions, on retire la classe "centered" pour placer l'overlay en haut
    function displayQuestionWithPrefix(current, total, questionText) {
      questionOverlay.classList.remove('centered');
      questionOverlay.innerHTML = "<p style='font-size:16px; text-align:center;'>Question " + current + "/" + total + " : " + questionText + "</p>";
      questionOverlay.style.display = 'flex';
    }

    async function initiateRecording() {
      const stream = await setupCamera();
      if (!stream) return;
      if (!window.MediaRecorder || typeof MediaRecorder.isTypeSupported === 'undefined') {
        const improErrorDiv = document.getElementById('impro-error');
        improErrorDiv.textContent = "Ton navigateur ne supporte pas l'enregistrement vidéo.";
        improErrorDiv.style.display = 'block';
        return;
      }
      mediaRecorderInstance = new MediaRecorder(stream);
      recordedChunks = [];
      mediaRecorderInstance.ondataavailable = (event) => {
        if (event.data.size > 0) {
          recordedChunks.push(event.data);
        }
      };
      mediaRecorderInstance.onstop = () => {
        const videoBlob = new Blob(recordedChunks, { type: 'video/mp4' });
        videoURL = URL.createObjectURL(videoBlob);
        stream.getTracks().forEach(t => t.stop());
        // Pour le message final, on remet l'overlay centré
        questionOverlay.classList.add('centered');
        questionOverlay.innerHTML = "<p style='color: white; font-size: 18px; text-align: center;'>Entretien terminé. Passe à l'étape suivante !</p>";
        questionOverlay.style.display = 'flex';
        document.getElementById('impro-error').style.display = 'none';
        recordingIndicator.style.display = 'none';
        clearInterval(timerInterval);
        improStarted = true;
        removePulseFromAll();
        nextBtns[3].classList.add('pulse');
        if (window.innerWidth <= 600) {
            document.querySelector('.video-box').style.height = "300px";
        }
        restartBtn.classList.remove('hidden-btn');
        nextQuestionBtn.classList.add('hidden-btn');
      };

      const questions = await loadSubjects(currentCategory);
      if (!questions || questions.length === 0) {
        const improErrorDiv = document.getElementById('impro-error');
        improErrorDiv.textContent = "Aucune question n'est disponible pour le moment.";
        improErrorDiv.style.display = 'block';
        return;
      }
      currentQuestionIndex = 1;
      displayQuestionWithPrefix(currentQuestionIndex, selectedQuestionCount, questions[0]);

      mediaRecorderInstance.start();
      recordingIndicator.style.display = 'flex';
      countdownElement.style.display = 'block';
      stopBtn.classList.remove('hidden-btn');
      stopBtn.disabled = false;
      if(selectedQuestionCount > 1) {
        nextQuestionBtn.classList.remove('hidden-btn');
      }
      restartBtn.classList.add('hidden-btn');
      startTwoMinutesCycle(questions);
    }

    async function setupCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
        preview.srcObject = stream;
        return stream;
      } catch (error) {
        const improErrorDiv = document.getElementById('impro-error');
        if (error.name === 'NotAllowedError') {
          improErrorDiv.textContent = "Vous avez refusé l'accès à la webcam. Veuillez autoriser l'accès.";
        } else if (error.name === 'NotFoundError') {
          improErrorDiv.textContent = "Aucune caméra/micro détecté.";
        } else {
          improErrorDiv.textContent = "Erreur : Impossible d'accéder à la webcam.";
        }
        improErrorDiv.style.display = 'block';
        console.error(error);
        return null;
      }
    }

    // Cycle de 2 minutes pour changer de question
    function startTwoMinutesCycle(questions) {
      let timeRemaining = 120;
      updateCountdownDisplay(timeRemaining);

      timerInterval = setInterval(() => {
        timeRemaining--;
        if (timeRemaining >= 0) {
          updateCountdownDisplay(timeRemaining);
        }
        if (timeRemaining <= 0) {
          if(currentQuestionIndex < selectedQuestionCount) {
            currentQuestionIndex++;
            let questionText;
            if (currentQuestionIndex === 1) {
              questionText = questions[0];
            } else {
              const otherQuestions = questions.slice(1);
              questionText = otherQuestions[Math.floor(Math.random() * otherQuestions.length)];
            }
            displayQuestionWithPrefix(currentQuestionIndex, selectedQuestionCount, questionText);
            timeRemaining = 120;
          } else {
            mediaRecorderInstance.stop();
            clearInterval(timerInterval);
            stopBtn.classList.add('hidden-btn');
            stopBtn.disabled = true;
          }
        }
      }, 1000);
    }

    function updateCountdownDisplay(seconds) {
      const minutes = Math.floor(seconds / 60);
      const sec = seconds % 60;
      countdownElement.textContent = `${minutes}:${sec < 10 ? '0' + sec : sec}`;
    }

    stopBtn.addEventListener('click', () => {
      if (mediaRecorderInstance && mediaRecorderInstance.state === 'recording') {
        mediaRecorderInstance.stop();
        clearInterval(timerInterval);
        stopBtn.classList.add('hidden-btn');
        stopBtn.disabled = true;
        nextQuestionBtn.classList.add('hidden-btn');
        restartBtn.classList.remove('hidden-btn');
        recordingIndicator.style.display = 'none';
      }
    });

    nextQuestionBtn.addEventListener('click', () => {
      // Si l'entretien n'a pas démarré, afficher un message d'erreur
      if (!mediaRecorderInstance || mediaRecorderInstance.state !== 'recording') {
        const improErrorDiv = document.getElementById('impro-error');
        improErrorDiv.textContent = "Veuillez démarrer l'entretien avant de passer à la question suivante.";
        improErrorDiv.style.display = 'block';
        return;
      }
      clearInterval(timerInterval);
      let timeRemaining = 120;
      loadSubjects(currentCategory).then(questions => {
        if(currentQuestionIndex < selectedQuestionCount) {
          currentQuestionIndex++;
          let questionText;
          if (currentQuestionIndex === 1) {
            questionText = questions[0];
          } else {
            const otherQuestions = questions.slice(1);
            questionText = otherQuestions[Math.floor(Math.random() * otherQuestions.length)];
          }
          displayQuestionWithPrefix(currentQuestionIndex, selectedQuestionCount, questionText);
          updateCountdownDisplay(timeRemaining);
          startTwoMinutesCycle(questions);
        } else {
          mediaRecorderInstance.stop();
        }
      });
    });

    restartBtn.addEventListener('click', () => {
      restartBtn.classList.add('hidden-btn');
      // Pour revenir à l'état initial, on ajoute la classe "centered" afin de centrer le contenu
      questionOverlay.classList.add('centered');
      questionOverlay.innerHTML = `
        <p style="font-size:16px; text-align:center;">
          Ici va s'enregistrer ton entretien vidéo.<br>
          Lorsque tu es prêt, clique sur le bouton ci-dessous.
        </p>
        <button id="start-btn" aria-label="Démarrer l'entretien">
          Démarrer ton entretien <i class="fas fa-video"></i>
        </button>
        <p style="font-size:12px;">NB : ta vidéo est stockée sur ton appareil. Aucun enregistrement n'est conservé par Letmotiv.</p>
      `;
      questionOverlay.style.display = 'flex';
      improStarted = false;
      bindStartButton();
    });

    bindStartButton();

    /***********************
     * STEP4 : Téléchargement et affichage de deux boutons
     ***********************/
    const validateFormBtn = document.getElementById('validate-form-btn');
    const step4Extra = document.getElementById('step4-extra');
    const redoBtn = document.getElementById('redo-btn');
    const resourcesBtn = document.getElementById('resources-btn');

    validateFormBtn.addEventListener('click', () => {
      if (videoURL) {
        const link = document.createElement('a');
        link.href = videoURL;
        link.download = 'Letmotiv_Simulation_Entretien.mp4';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
      document.querySelector('.call-to-action').style.display = 'none';
      step4Extra.style.display = 'block';
    });

    redoBtn.addEventListener('click', () => {
      window.location.reload();
    });

    resourcesBtn.addEventListener('click', () => {
      window.location.href = "https://www.letmotiv.fr/simulateur-prise-de-parole-en-public/entretien-candidat";
    });
  </script>
</body>
</html>
