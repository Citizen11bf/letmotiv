<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simulateur d'improvisation</title>
  <meta name="description" content="√âvaluer et d√©velopper sa prise de parole en public avec le simulateur d'improvisation Letmotiv. Entreprise sp√©cialis√©e dans le coaching en prise de parole.">

  <!-- Ic√¥ne de la page (favicon) -->
  <link rel="icon" href="https://raw.githubusercontent.com/Citizen11bf/letmotiv/refs/heads/images/Letmotiv_favicon.webp" type="image/png">
  <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/Citizen11bf/letmotiv/refs/heads/images/Letmotiv_favicon.webp">
  
  <!-- Balises Open Graph pour LinkedIn -->
  <meta property="og:title" content="Simulateur d'improvisation Letmotiv" />
  <meta property="og:description" content="√âvaluer et d√©velopper sa prise de parole en public avec le simulateur d'improvisation Letmotiv." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://letmotiv-simulateur.fr" />
  <meta property="og:image" content="https://i.postimg.cc/LXxJLTVx/Letmotiv-og-image.png" />
  <meta property="og:image:alt" content="Illustration d'une improvisation en public avec un orateur sur sc√®ne." />
  <meta name="author" content="Simulateur d'improvisation Letmotiv" />
  <meta property="article:published_time" content="2025-01-26" />

  <!-- Balises Twitter (optionnel) -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Simulateur d'improvisation Letmotiv">
  <meta name="twitter:description" content="√âvaluer et d√©velopper sa prise de parole en public avec le simulateur d'improvisation Letmotiv.">
  <meta name="twitter:image" content="https://i.postimg.cc/LXxJLTVx/Letmotiv-og-image.png">

  <!-- Import de la police DM Sans et Montserrat depuis Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans&family=Montserrat:wght@700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Poppins:900i" rel="stylesheet">
  
  <!-- Ic√¥nes Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

  <!-- Calendly widget CSS -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">

  <!-- JSON-LD pour le SEO -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Simulateur d'improvisation Letmotiv",
      "url": "https://letmotiv-simulateur.fr",
      "description": "√âvaluer et d√©velopper sa prise de parole en public avec le simulateur d'improvisation Letmotiv.",
      "publisher": {
        "@type": "Organization",
        "name": "Letmotiv",
        "logo": "https://letmotiv-simulateur.fr/logo.png"
      }
    }
  </script>
  
  <!-- Styles CSS Global -->
  <style>
    /* --- GLOBAL --- */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'DM Sans', sans-serif;
      background-color: #ffffff;
      color: #333333;
      padding-top: 60px;
      padding-bottom: 20px;
    }
    /* --- ERROR MESSAGES --- */
    .error-message {
      color: red;
      font-size: 14px;
      margin-top: 5px;
    }
    /* --- HEADER --- */
    .header {
      background-color: #182d84;
      color: #FFFFFF;
      font-size: 16px;
      font-weight: bold;
      text-align: center;
      padding: 10px;
      width: 100%;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 10;
    }
    .header-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 5px;
      max-width: 100%;
      overflow-wrap: break-word;
    }
    .header-l2 { font-size: 14px; font-weight: normal; }
    /* --- BARRE DE PROGRESSION --- */
    .progress-container {
      position: fixed;
      top: 60px;
      left: 0;
      width: 100%;
      height: 10px;
      background-color: rgba(24, 45, 132, 0.1);
      z-index: 9;
    }
    .progress-bar {
      width: 0%;
      height: 100%;
      background-color: #00a48a;
      transition: width 0.5s ease;
    }
    /* --- BO√éTE D'INTRODUCTION --- */
    .intro-box {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(135deg, #182d84, #00a48a);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #ffffff;
      z-index: 20;
      animation: fadeIn 1s ease forwards;
    }
    .intro-box h1 {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.8rem;
      margin-bottom: 50px;
      animation: slideDown 1s ease forwards;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
    }
    .intro-box h1 span { display: block; }
    .wrapper { display: flex; justify-content: center; }
    .cta {
      display: flex;
      padding: 10px 45px;
      text-decoration: none;
      font-family: 'Poppins', sans-serif;
      font-size: 40px;
      color: white;
      background: #FF5722;
      transition: 0.5s;
      box-shadow: 6px 6px 0 black;
      transform: skewX(-15deg);
      border-radius: 8px;
    }
    .cta:focus { outline: none; }
    .cta:hover { transition: 0.3s; box-shadow: 10px 10px 0 #FBC638; }
    .cta span:nth-child(2) { transition: 0.3s; margin-right: 0px; }
    .cta:hover span:nth-child(2) { transition: 0.3s; margin-right: 45px; }
    .cta span { transform: skewX(15deg); }
    .cta span:nth-child(2) {
      width: 20px;
      margin-left: 30px;
      position: relative;
      top: 12%;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
    @keyframes slideDown { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    /* --- CONTENEUR PRINCIPAL --- */
    .main-container { position: relative; padding: 20px; }
    /* --- BOXES (√©tapes) --- */
    .box {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: 20px auto;
      padding: 20px;
      border-radius: 15px;
      background: linear-gradient(135deg, #ffffff, #f9f9f9);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
      font-size: 14px;
      display: none;
      transition: opacity 0.5s ease;
    }
    .box.active { display: block; opacity: 1; }
    .box.hidden { opacity: 0; }
    /* --- ANIMATIONS VERTICALES --- */
    .slide-from-bottom { animation: fromBottom 1.5s ease forwards; }
    @keyframes fromBottom { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
    .slide-from-top { animation: fromTop 1.5s ease forwards; }
    @keyframes fromTop { from { opacity: 0; transform: translateY(-50px); } to { opacity: 1; transform: translateY(0); } }
    /* --- HEADER INTERNE DES BOXES --- */
    .box-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      position: relative;
    }
    .back-btn {
      border: none;
      background-color: #808080;
      color: #FFFFFF;
      font-size: 16px;
      cursor: pointer;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s, transform 0.3s;
      margin: 0 auto 10px;
    }
    .back-btn:hover { background-color: #505050; transform: scale(1.1); }
    .back-btn:active { background-color: #303030; }
    #step1 .back-btn.hidden-visibility { display: none; }
    .box-title { font-size: 16px; font-weight: bold; color: #182d84; text-align: center; }
    /* --- FLECHES HAUT/BAS --- */
    .next-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #182d84;
      background-color: transparent;
      color: #182d84;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s, transform 0.3s;
      margin: 10px auto;
    }
    .next-btn:hover { background-color: #00a48a; color: #ffffff; transform: scale(1.05); }
    .next-btn.pulse { animation: electricPulse 1.5s infinite; }
    @keyframes electricPulse {
      0% { box-shadow: 0 0 0 0 rgba(0,164,138,0.7); }
      70% { box-shadow: 0 0 0 10px rgba(0,164,138,0); }
      100% { box-shadow: 0 0 0 0 rgba(0,164,138,0); }
    }
    .btn-impro {
      margin: 15px 0;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .btn-impro:hover { background-color: #00a48a; }
    /* --- STEP1 : Choix d‚Äôobjectif --- */
    .objectives-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
      justify-items: center;
      margin: 10px 0;
    }
    .objective-item {
      text-align: center;
      color: #444;
      font-size: 0.9rem;
      cursor: pointer;
      padding: 12px;
      border: 1px solid transparent;
      border-radius: 10px;
      transition: background-color 0.3s, border-color 0.3s, transform 0.3s;
    }
    .objective-item i {
      font-size: 1.8rem;
      margin-bottom: 8px;
      display: block;
    }
    .objective-item:hover { border-color: #00a48a; background-color: rgba(0, 164, 138, 0.1); }
    .objective-item.selected-objective {
      transform: scale(1.1);
      background-color: rgba(0, 164, 138, 0.2);
      color: #00a48a;
      border-color: #00a48a;
      transition: all 0.3s ease-in-out;
    }
    .objective-item.selected-objective i { color: #00a48a; }
    .objective-item[data-category="convaincre"] i { color: #007BFF; }
    .objective-item[data-category="inspirer"] i { color: #FFC107; }
    .objective-item[data-category="toast"] i { color: #E91E63; }
    .objective-item[data-category="repartie"] i { color: #9C27B0; }
    .objective-item[data-category="vendre"] i { color: #4CAF50; }
    .objective-item[data-category="conflit"] i { color: #F44336; }
    .objective-item[data-category="diction"] i { color: #00BCD4; }
    .objective-item[data-category="entretien"] i { color: #795548; }
    .objective-item[data-category="lacher-prise"] i { color: #FF5722; }
    
    /* --- STEP2 : G√©n√©ration du sujet --- */
    #objective-reminder { color: grey; font-size: 0.8rem; margin-bottom: 10px; }
    #current-objective { text-transform: lowercase; }
    #subject-wrapper {
      margin-top: 10px;
      background: linear-gradient(135deg, #00a48a, #182d84);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      font-size: 16px;
      font-weight: normal;
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      display: none;
    }
    #advice-toggle {
      cursor: pointer;
      margin-top: 20px;
      margin-bottom: 20px;
      text-align: center;
      font-weight: normal;
      color: #182d84;
    }
    #advice-toggle i {
      margin-left: 5px;
      transition: transform 0.3s ease;
    }
    #advice-text {
      display: none;
      margin-top: 10px;
      padding: 10px;
      background-color: #fefefe;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.5;
      text-align: left;
    }
    .mobile-break { display: none; }
    @media (max-width: 600px) { .mobile-break { display: inline; } }
    /* --- STEP3 : Enregistrement vid√©o --- */
    .subject-bubble {
      display: inline-block;
      position: relative;
      background: #fefefe;
      border: 2px solid #ccc;
      border-radius: 16px;
      padding: 10px 10px;
      font-size: 14px;
      color: #333;
      text-align: center;
      margin: 0 auto;
      max-width: 90%;
    }
    .video-box {
      margin: 10px auto;
      border: 3px solid #182d84;
      border-radius: 6px;
      max-width: 500px;
      background-color: #fefefe;
      height: 300px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      transition: height 0.5s ease-in-out;
    }
    .video-box video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 4px;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
      transform: scaleX(-1);
      -webkit-transform: scaleX(-1);
    }
    .video-overlay {
      position: absolute;
      z-index: 2;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: #555;
      font-style: italic;
      font-size: 14px;
      padding: 20px;
      background: rgba(255,255,255,0.6);
    }
    .video-overlay p { margin: 10px 0; }
    .video-overlay button {
      margin: 15px 0;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .video-overlay button:hover { background-color: #00a48a; }
    .recording-indicator {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      align-items: center;
      background-color: rgba(255,255,255,0.8);
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 14px;
      color: #ff0000;
      display: none;
      z-index: 3;
    }
    .recording-indicator .dot {
      height: 10px;
      width: 10px;
      background-color: #ff0000;
      border-radius: 50%;
      display: inline-block;
      margin-right: 5px;
      animation: blink 1s infinite;
    }
    @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
    .countdown {
      position: absolute;
      bottom: 10px;
      right: 10px;
      font-size: 24px;
      color: #ffffff;
      display: none;
      z-index: 4;
      background-color: rgba(0,0,0,0.5);
      padding: 5px 10px;
      border-radius: 5px;
      text-align: center;
    }
    .initial-countdown-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(128,128,128,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 5;
      border-radius: 6px;
    }
    .initial-countdown {
      font-size: 48px;
      color: #ffffff;
      font-weight: bold;
    }
    .impro-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 10px;
    }
    .hidden-btn { display: none; }
    .download-fields {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      margin-bottom: 15px;
    }
    .input-group {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      width: 48%;
    }
    .input-group label { margin-bottom: 5px; font-weight: bold; color: #000; }
    .input-group input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-family: 'DM Sans', sans-serif;
      font-size: 14px;
      transition: border-color 0.3s;
    }
    .input-group input:focus { border-color: #00a48a; outline: none; }
    .linkedin-share-btn {
      position: fixed;
      bottom: 15px;
      right: 15px;
      background-color: #0077B5;
      color: #fff;
      font-size: 14px;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
      transition: background-color 0.3s, transform 0.2s;
      z-index: 100;
      display: none;
    }
    .linkedin-share-btn:hover {
      background-color: #005582;
      transform: scale(1.1);
    }
    .linkedin-share-btn i { font-size: 18px; }
    @media (max-width: 600px) {
      h1 .line { display: block; }
      .intro-box h1 { font-size: 1.8rem; }
      .cta { padding: 8px 30px !important; font-size: 30px !important; }
      .cta svg { width: 40px !important; height: auto !important; }
      .cta span:nth-child(2) { margin-left: 20px !important; width: 15px !important; top: 10% !important; }
    }
    @media (max-width: 600px) {
      .objectives-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding: 0 5px;
        margin: 10px auto;
        box-sizing: border-box;
      }
      .objective-item {
        position: relative;
        display: flex;
        justify-content: space-between;
        align-items: center; 
        background-color: #f0f1f5;
        border-radius: 10px;
        padding: 14px 20px 14px 14px; 
        width: 100%;
        box-sizing: border-box;
        font-size: 1rem;
        font-family: 'DM Sans', sans-serif;
        color: #333;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.2s;
        border: none;
      }
      .objective-item i {
        position: absolute;
        bottom: 0px;
        right: 10px;
        font-size: 2.0rem;
        color: #444;
      }
      .objective-item span { flex: 1; text-align: left; }
      .objective-item:nth-child(odd) i { transform: rotate(-10deg); }
      .objective-item:nth-child(even) i { transform: rotate(10deg); }
      .objective-item:hover { background-color: #e5e7eb; transform: translateY(-1px); }
      .objective-item:active { transform: translateY(0); background-color: #dcdfe3; }
      .mobile-explanation { font-size: 0.8rem; color: #555; font-weight: bold; margin: 4px 10px 8px; text-align: left; }
    }
    @media (min-width: 601px) {
      .main-container { display: flex; justify-content: center; align-items: center; min-height: calc(100vh - 60px); }
      .box { position: relative; margin: 0 auto; }
      .objectives-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        margin: 20px 0;
        padding: 0 10px;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }
      .objective-item {
        background-color: #f7f9fc;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        border-radius: 8px;
        transition: transform 0.3s, background-color 0.3s, color 0.3s;
        flex: 1 1 150px;
        text-align: center;
      }
      .objective-item i { color: #777; transition: color 0.3s; }
      .objective-item:hover { transform: scale(1.03); background-color: #00a48a; }
      .objective-item:hover i { color: #fff; }
      .objective-item:hover span { color: #fff; }
    }
    
    /* --- STEP4 : Bilan - T√©l√©chargement, Analyse & Prise de rendez-vous --- */
    #step4 .download-section-accent {
      background: linear-gradient(135deg, #182d84, #00a48a);
      padding: 15px 30px;
      border-radius: 12px;
      color: #fff;
      margin-bottom: 20px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      font-size: 1.0rem;
    }
    @media (max-width: 600px) {
       #step4 .download-section-accent {
        font-size: 0.8rem;
      }
    }
    
    /* Conteneur d'actions (3 call-to-actions) */
    .action-container {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin: 20px 0;
      gap: 10px;
    }
    .action-square {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 150px;
      height: 150px;
      background-color: #FF5722;
      color: #fff;
      text-decoration: none;
      border-radius: 10px;
      transition: transform 0.3s, background-color 0.3s, color 0.3s;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      cursor: pointer;
    }
    .action-square:hover {
      transform: scale(1.05);
      background-color: #FBC638;
      color: #000;
    }
    .action-square i {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    .action-square span {
      font-size: 1rem;
      text-align: center;
      display: block;
      padding: 0 5px;
    }
    
    /* --- STEP4 - Newsletter --- */
    .btn-newsletter {
      background: linear-gradient(135deg, #182d84, #00a48a);
      color: #fff;
      font-weight: bold;
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      margin: 10px 0;
    }
    .btn-newsletter:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    .newsletter-container {
      width: 100%;
      max-width: 600px;
      background-color: #2d3748;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      padding: 20px;
      margin: 30px auto;
      color: #e2e8f0;
      text-align: center;
    }
    .newsletter-title {
      font-size: 1.0rem;
      font-weight: normal;
      margin-bottom: 20px;
    }
    .newsletter-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .newsletter-form input::placeholder {
      color: #fff;
    }
    .newsletter-form input {
      background-color: #4a5568;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px;
      outline: none;
      transition: background-color 0.3s, box-shadow 0.3s;
    }
    .newsletter-form input:focus {
      background-color: #2d3748;
      box-shadow: 0 0 0 1px #3182ce;
    }
    .newsletter-error {
      color: red;
      font-size: 0.8rem;
      text-align: left;
    }
    .newsletter-success {
      color: green;
      font-size: 0.9rem;
      margin-top: 10px;
    }
    
    /* --- STEP5 : Prise de contact (via Calendly) --- */
    .calendy {
      text-align: center;
    }
    .calendy .container {
      padding: 10px 0;
    }
  </style>
</head>
<body>
  
  <!-- BO√éTE D'INTRODUCTION -->
  <div class="intro-box" id="intro-box">
    <h1>
      <span class="line">ENTRAINE-TOI</span>
      <span class="line">A LA PRISE DE PAROLE</span>
      <span class="line">EN PUBLIC</span>
    </h1> 
    <div class="wrapper">
      <a id="start-intro-btn" class="cta" href="#">
        <span>COMMENCER</span>
        <span>
          <svg width="66px" height="43px" viewBox="0 0 66 43" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <g id="arrow" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <path class="one" d="M40.1543933,3.89485454 L43.9763149,0.139296592 C44.1708311,-0.0518420739 44.4826329,-0.0518571125 44.6771675,0.139262789 L65.6916134,20.7848311 C66.0855801,21.1718824 66.0911863,21.8050225 65.704135,22.1989893 C65.7000188,22.2031791 65.6958657,22.2073326 65.6916762,22.2114492 L44.677098,42.8607841 C44.4825957,43.0519059 44.1708242,43.0519358 43.9762853,42.8608513 L40.1545186,39.1069479 C39.9575152,38.9134427 39.9546793,38.5968729 40.1481845,38.3998695 C40.1502893,38.3977268 40.1524132,38.395603 40.1545562,38.3934985 L56.9937789,21.8567812 C57.1908028,21.6632968 57.193672,21.3467273 57.0001876,21.1497035 C56.9980647,21.1475418 56.9959223,21.1453995 56.9937605,21.1432767 L40.1545208,4.60825197 C39.9574869,4.41477773 39.9546013,4.09820839 40.1480756,3.90117456 C40.1501626,3.89904911 40.1522686,3.89694235 40.1543933,3.89485454 Z" fill="#FFFFFF"></path>
              <path class="two" d="M20.1543933,3.89485454 L23.9763149,0.139296592 C24.1708311,-0.0518420739 24.4826329,-0.0518571125 24.6771675,0.139262789 L45.6916134,20.7848311 C46.0855801,21.1718824 46.0911863,21.8050225 45.704135,22.1989893 C45.7000188,22.2031791 45.6958657,22.2073326 45.6916762,22.2114492 L24.677098,42.8607841 C24.4825957,43.0519059 24.1708242,43.0519358 23.9762853,42.8608513 L20.1545186,39.1069479 C19.9575152,38.9134427 19.9546793,38.5968729 20.1481845,38.3998695 C20.1502893,38.3977268 20.1524132,38.395603 20.1545562,38.3934985 L36.9937789,21.8567812 C37.1908028,21.6632968 37.193672,21.3467273 37.0001876,21.1497035 C36.9980647,21.1475418 36.9959223,21.1453995 36.9937605,21.1432767 L20.1545208,4.60825197 C19.9574869,4.41477773 19.9546013,4.09820839 20.1480756,3.90117456 C20.1501626,3.89904911 20.1522686,3.89694235 20.1543933,3.89485454 Z" fill="#FFFFFF"></path>
              <path class="three" d="M0.154393339,3.89485454 L3.97631488,0.139296592 C4.17083111,-0.0518420739 4.48263286,-0.0518571125 4.67716753,0.139262789 L25.6916134,20.7848311 C26.0855801,21.1718824 26.0911863,21.8050225 25.704135,22.1989893 C25.7000188,22.2031791 25.6958657,22.2073326 25.6916762,22.2114492 L4.67709797,42.8607841 C4.48259567,43.0519059 4.17082418,43.0519358 3.97628526,42.8608513 L0.154518591,39.1069479 C-0.0424848215,38.9134427 -0.0453206733,38.5968729 0.148184538,38.3998695 C0.150289256,38.3977268 0.152413239,38.395603 0.154556228,38.3934985 L16.9937789,21.8567812 C17.1908028,21.6632968 17.193672,21.3467273 17.0001876,21.1497035 C16.9980647,21.1475418 16.9959223,21.1453995 16.9937605,21.1432767 L0.15452076,4.60825197 C-0.0425130651,4.41477773 -0.0453986756,4.09820839 0.148075568,3.90117456 C0.150162624,3.89904911 0.152268631,3.89694235 0.154393339,3.89485454 Z" fill="#FFFFFF"></path>
            </g>
          </svg>
        </span>
      </a>
    </div>
  </div>

  <!-- FORMULAIRE CACH√â POUR GOOGLE FORMS -->
  <form id="hidden-google-form" action="https://docs.google.com/forms/d/e/1FAIpQLSfGAcKp0cV5AeVJCJBPbtKLKCLhbYySZf_FkiMg85WKVFUn6A/formResponse" method="POST" target="hidden_iframe" style="display:none;">
    <input type="text" name="entry.1119647353" id="hidden-prenom">
    <input type="email" name="entry.638831312" id="hidden-email">
  </form>
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

  <!-- HEADER -->
  <div class="header">
    <div class="header-content">
      <div class="header-l1">Coaching en prise de parole</div>
      <div class="header-l2">Simulateur d'improvisation Letmotiv</div>
    </div>
  </div>

  <!-- BARRE DE PROGRESSION -->
  <div class="progress-container">
    <div class="progress-bar" id="top-progress-bar"></div>
  </div>

  <!-- CONTAINER PRINCIPAL -->
  <div class="main-container">
    <!-- STEP1 : Choix d'objectif -->
    <div class="box" id="step1">
      <div class="box-header">
        <button class="back-btn hidden-visibility" id="back-btn1" aria-label="Retour">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Quel est ton objectif ?</div>
      </div>
      <div class="objectives-container">
        <div class="objective-item" data-category="diction">
          <i class="fas fa-grin-tongue"></i>
          <span>Am√©liorer sa diction</span>
        </div>
        <div class="objective-item" data-category="repartie">
          <i class="fas fa-comments"></i>
          <span>Avoir de la r√©partie</span>
        </div>
        <div class="objective-item" data-category="convaincre">
          <i class="fas fa-handshake"></i>
          <span>Convaincre</span>
        </div>
        <div class="objective-item" data-category="conflit">
          <i class="fas fa-exclamation-triangle"></i>
          <span>G√©rer un conflit</span>
        </div>
        <div class="objective-item" data-category="inspirer">
          <i class="fas fa-lightbulb"></i>
          <span>Inspirer</span>
        </div>
        <div class="objective-item" data-category="lacher-prise">
          <i class="fas fa-smile"></i>
          <span>L√¢cher prise</span>
        </div>
        <div class="objective-item" data-category="toast">
          <i class="fas fa-glass-cheers"></i>
          <span>Porter un toast</span>
        </div>
        <div class="objective-item" data-category="entretien">
          <i class="fas fa-briefcase"></i>
          <span>R√©ussir son entretien</span>
        </div>
        <div class="objective-item" data-category="vendre">
          <i class="fas fa-money-bill-wave"></i>
          <span>Vendre</span>
        </div>
      </div>
      <div id="explanation-box" class="explanation-box"></div>
      <div id="objective-error" class="error-message"></div>
      <button class="next-btn" id="next-btn1" aria-label="√âtape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP2 : G√©n√©ration du sujet -->
    <div class="box" id="step2">
      <div class="box-header">
        <button class="back-btn" id="back-btn2" aria-label="Retour √† l'√©tape pr√©c√©dente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Pr√™t √† relever le d√©fi ?</div>
      </div>
      <button id="generate-subject-btn" class="btn-impro">G√©n√©rer un sujet  <i class="fas fa-random"></i></button>
      <div id="subject-wrapper">
        <span id="subject-display"></span>
      </div>
      <div id="advice-toggle">
        Des conseils avant de d√©marrer<span class="mobile-break"><br></span> ta simulation ? <i id="advice-icon" class="fas fa-chevron-down"></i>
      </div>
      <div id="advice-text">
        1) Positionne tes yeux √† hauteur de la cam√©ra. <br><br>
        2) Choisis un fond neutre pour √©viter toute distraction.<br><br>
        3) Assure-toi que l'√©clairage te met en valeur. <br><br>
        4) V√©rifie que le son et la vid√©o fonctionnent.<br><br>
        5) Reste concentr√© et prends du plaisir. 
      </div>
      <div id="subject-error" class="error-message"></div>
      <button class="next-btn" id="next-btn2" aria-label="√âtape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP3 : Enregistrement vid√©o -->
    <div class="box" id="step3">
      <div class="box-header">
        <button class="back-btn" id="back-btn3" aria-label="Retour √† l'√©tape pr√©c√©dente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">C'est parti, lance ton improvisation !</div>
      </div>
      <div id="current-subject-display" class="subject-bubble"></div>
      <div class="video-box">
        <video id="preview" autoplay muted playsinline webkit-playsinline></video>
        <div class="video-overlay">
          <p>Ta vid√©o va s'enregistrer ici.</p>
          <button id="start-btn" aria-label="D√©marrer l'improvisation">
            D√©marrer ton impro <i class="fas fa-video"></i>
          </button>
          <p>NB : ta vid√©o est stock√©e sur ton appareil. Aucun enregistrement n'est conserv√© par Letmotiv.</p>
        </div>
        <div class="recording-indicator" id="recording-indicator">
          <span class="dot"></span> Enregistrement en cours
        </div>
        <div class="countdown" id="countdown">1:59</div>
        <div class="initial-countdown-overlay" id="initial-countdown-overlay">
          <div class="initial-countdown" id="initial-countdown">3</div>
        </div>
      </div>
      <div class="impro-actions">
        <button id="stop-btn" class="hidden-btn btn-impro" aria-label="Arr√™ter l'improvisation">
          Arr√™ter ton impro <i class="fas fa-stop"></i>
        </button>
        <button id="restart-btn" class="hidden-btn btn-impro" aria-label="Recommencer l'improvisation">
          Recommencer ton impro <i class="fas fa-redo"></i>
        </button>
      </div>
      <div id="impro-error" class="error-message"></div>
      <button class="next-btn" id="next-btn3" aria-label="√âtape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP4 : Bilan - T√©l√©chargement, Analyse & Prise de rendez-vous -->
    <div class="box" id="step4">
      <div class="box-header">
        <button class="back-btn" id="back-btn4" aria-label="Retour √† l'√©tape pr√©c√©dente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">C'est l'heure du bilan !</div>
      </div>
      <div class="download-section">
        <!-- Box d√©grad√©e "F√©licitations..." -->
        <div class="download-section-accent">
          <h2 style="font-weight: bold;">F√©licitations pour avoir r√©alis√© ton improvisation ! <span>ü§©</span></h2>
        </div>

        <!-- Conteneur d'actions avec 3 boutons carr√©s -->
        <div class="action-container">
          <a id="download-video-btn" class="action-square" aria-label="T√©l√©charge ta vid√©o">
            <i class="fas fa-download"></i>
            <span>T√©l√©charge ta vid√©o</span>
          </a>
          <a id="feedback-btn" class="action-square" aria-label="Analyse ta prestation">
            <i class="fas fa-chart-line"></i>
            <span>Analyse ta prestation</span>
          </a>
          <a id="contact-btn" class="action-square" aria-label="Prendre rdv avec un expert">
            <i class="fas fa-user-tie"></i>
            <span>Prendre rdv avec un expert</span>
          </a>
        </div>

         <!-- Zone d'affichage d'erreur sp√©cifique pour STEP4 -->
          <div id="action-error" class="error-message" style="display:none;"></div>
        
        <!-- Section Newsletter -->
        <div class="newsletter-container">
          <h2 class="newsletter-title">Inscris-toi √† la newsletter Letmotiv <br>pour progresser et prendre la parole avec impact :</h2>
          <form id="newsletter-form" class="newsletter-form">
            <input type="text" id="newsletter-prenom" placeholder="Pr√©nom" aria-label="Pr√©nom">
            <div id="newsletter-prenom-error" class="newsletter-error"></div>
            <input type="email" id="newsletter-email" placeholder="Votre email" aria-label="Email">
            <div id="newsletter-email-error" class="newsletter-error"></div>
            <button type="submit" id="newsletter-submit-btn" class="btn-newsletter">S'abonner</button>
          </form>
          <div id="newsletter-success" class="newsletter-success" style="display: none;">Tu es maintenant abonn√© √† la newsletter Letmotiv.</div>
        </div>
      </div>
    </div>

    <!-- STEP5 : Prise de contact (Calendly) -->
    <div class="box" id="step5">
      <div class="box-header">
        <button class="back-btn" id="back-btn5" aria-label="Retour √† l'√©tape pr√©c√©dente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Planifiez un appel avec nous</div>
      </div>
      <main>
        <section id="calendy" class="section calendy">
          <div class="container">
            <!-- Calendly inline widget -->
            <div class="calendly-inline-widget" data-url="https://calendly.com/letmotiv/premier-contact?hide_event_type_details=1" style="min-width:320px;height:1000px;"></div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <!-- Bouton de partage LinkedIn -->
  <button class="linkedin-share-btn" id="linkedin-share-btn" aria-label="Partager sur LinkedIn">
    <i class="fab fa-linkedin-in"></i>
  </button>

  <!-- Calendly widget script -->
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

  <!-- SCRIPT JavaScript -->
  <script>
    /***********************
     * VARIABLES ET CONSTANTES
     ***********************/
    const boxes = {
      1: document.getElementById('step1'),
      2: document.getElementById('step2'),
      3: document.getElementById('step3'),
      4: document.getElementById('step4'),
      5: document.getElementById('step5')
    };

    const nextBtns = {
      1: document.getElementById('next-btn1'),
      2: document.getElementById('next-btn2'),
      3: document.getElementById('next-btn3')
    };

    // Pour les boutons de retour, on g√®re maintenant step2, step3, step4, et step5
    const backBtns = {
      2: document.getElementById('back-btn2'),
      3: document.getElementById('back-btn3'),
      4: document.getElementById('back-btn4'),
      5: document.getElementById('back-btn5')
    };

    const introBox = document.getElementById('intro-box');
    const startIntroBtn = document.getElementById('start-intro-btn');
    const topProgressBar = document.getElementById('top-progress-bar');
    const linkedinShareBtn = document.getElementById('linkedin-share-btn');

    let currentStep = 0;
    let currentCategory = null;
    let currentObjective = "";
    let currentSubject = "";
    let isImproRecordingStarted = false;
    let mediaRecorderInstance;
    let recordedChunks = [];
    let videoURL = "";
    let timerInterval;
    let timeRemaining = 120;
    let countdown;
    // Variable pour v√©rifier le t√©l√©chargement de la vid√©o
    let videoDownloaded = false;

    /***********************
     * GESTION DE L'HISTORIQUE (pushState/popstate)
     ***********************/
    function pushStepState(step) {
      history.pushState({ step }, null, `#step${step}`);
    }

    window.addEventListener('popstate', (event) => {
      if (event.state && event.state.step) {
        const stepToShow = event.state.step;
        // Masquer toutes les boxes
        Object.values(boxes).forEach(box => box.classList.remove('active'));
        // Afficher la box correspondante
        boxes[stepToShow].classList.add('active');
        currentStep = stepToShow;
        updateProgressBar(stepToShow);
        // Si on revient au STEP3, afficher le sujet g√©n√©r√©
        if (stepToShow == 3) {
          document.getElementById('current-subject-display').textContent = currentSubject;
        }
      } else {
        // Par d√©faut, afficher l'intro si aucun state n'est d√©fini
        Object.values(boxes).forEach(box => box.classList.remove('active'));
        introBox.style.display = 'block';
        currentStep = 0;
      }
    });

    /***********************
     * FONCTIONS UTILITAIRES
     ***********************/
    function updateProgressBar(step) {
      const progress = (step / 5) * 100;
      topProgressBar.style.width = `${progress}%`;
    }

    function displayError(elementId, message) {
      const el = document.getElementById(elementId);
      el.textContent = message;
      el.style.display = 'block';
    }

    function updateShareButtonVisibility() {
      linkedinShareBtn.style.display = currentStep === 0 ? 'none' : 'flex';
    }

    /***********************
     * GESTION DE LA NAVIGATION ENTRE LES √âTAPES
     ***********************/
    function showBox(current, next) {
      if (!boxes[current] || !boxes[next]) return;
      boxes[current].classList.remove('active', 'slide-from-bottom', 'slide-from-top');
      boxes[next].classList.add('active');
      boxes[next].classList.add(next > current ? 'slide-from-bottom' : 'slide-from-top');
      updateProgressBar(next);
      currentStep = next;
      updateShareButtonVisibility();
      pushStepState(next);
      removePulseFromAll();
      // Si on passe au STEP3, mettre √† jour le sujet
      if(next == 3) {
        document.getElementById('current-subject-display').textContent = currentSubject;
      }
    }

    function initNavigationButtons() {
      nextBtns[1].addEventListener('click', () => {
        const selected = document.querySelector('.objectives-container .selected-objective');
        if (!selected) {
          displayError('objective-error', "S√©lectionne un objectif avant de continuer.");
          return;
        }
        showBox(1, 2);
      });
      nextBtns[2].addEventListener('click', () => {
        if (!currentSubject) {
          displayError('subject-error', "Tu dois g√©n√©rer un sujet avant de continuer.");
          return;
        }
        document.getElementById('current-subject-display').textContent = currentSubject;
        showBox(2, 3);
      });
      nextBtns[3].addEventListener('click', () => {
        const improErrorDiv = document.getElementById('impro-error');
        improErrorDiv.style.display = 'none';
        if (!currentSubject || !isImproRecordingStarted) {
          displayError('impro-error', "Tu dois lancer ton improvisation avant de continuer.");
          return;
        }
        showBox(3, 4);
      });
      backBtns[2].addEventListener('click', () => { showBox(2, 1); });
      backBtns[3].addEventListener('click', () => { showBox(3, 2); });
      backBtns[4].addEventListener('click', () => { showBox(4, 3); });
      backBtns[5].addEventListener('click', () => { showBox(5, 4); });
    }

    function removePulseFromAll() {
      Object.values(nextBtns).forEach(btn => btn.classList.remove('pulse'));
    }

    /***********************
     * INITIALISATION DE L'INTRODUCTION
     ***********************/
    startIntroBtn.addEventListener('click', () => {
      introBox.style.animation = 'fadeOut 0.5s ease forwards';
      setTimeout(() => {
        introBox.style.display = 'none';
        boxes[1].classList.add('active', 'slide-from-bottom');
        currentStep = 1;
        updateProgressBar(1);
        removePulseFromAll();
        updateShareButtonVisibility();
        pushStepState(1);
      }, 500);
    });

    /***********************
     * GESTION DES OBJECTIFS (STEP1)
     ***********************/
    const explanations = {
      convaincre:   "Tu as 2 minutes pour convaincre ton auditoire sur un sujet d√©licat",
      inspirer:     "Tu as 2 minutes pour inspirer ton auditoire",
      toast:        "Tu as 2 minutes pour porter un toast marquant lors d'un √©v√©nement",
      repartie:     "Savoir r√©pondre avec justesse et rapidit√© √† une remarque d√©sagr√©able au travail",
      vendre:       "Tu as 2 minutes pour vendre un objet insolite",
      conflit:      "G√®re un d√©saccord ou une tension avec diplomatie",
      diction:      "R√©p√®te une phrase complexe plusieurs fois de suite sans te tromper",
      entretien:    "Convaincs ton futur employeur que tu es la p√©pite qu'il recherche",
      'lacher-prise': "Oublie la censure et exprime ton grain de folie"
    };

    const txtFilesByCategory = {
      convaincre:   "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/convaincre.txt",
      inspirer:     "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/inspirer.txt",
      'lacher-prise': "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/lacher_prise.txt",
      toast:        "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/toast.txt",
      repartie:     "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/repartie.txt",
      vendre:       "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/vendre.txt",
      conflit:      "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/gerer_un_conflit.txt",
      diction:      "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/diction.txt",
      entretien:    "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/entretien.txt"
    };

    let subjectsCache = {
      convaincre: null,
      inspirer: null,
      'lacher-prise': null,
      toast: null,
      repartie: null,
      vendre: null,
      conflit: null,
      diction: null,
      entretien: null
    };

    // Tableau associant chaque cat√©gorie √† son ic√¥ne par d√©faut
    const defaultIcons = {
      convaincre: "fas fa-handshake",
      inspirer: "fas fa-lightbulb",
      "lacher-prise": "fas fa-smile",
      toast: "fas fa-glass-cheers",
      repartie: "fas fa-comments",
      vendre: "fas fa-money-bill-wave",
      conflit: "fas fa-exclamation-triangle",
      diction: "fas fa-grin-tongue",
      entretien: "fas fa-briefcase"
    };

    const objectivesButtons = document.querySelectorAll('.objectives-container .objective-item');
    const explanationBox = document.getElementById('explanation-box');

    objectivesButtons.forEach(item => {
      item.addEventListener('click', async () => {
        // Pour mobile, si l'item est d√©j√† s√©lectionn√© et que l'ic√¥ne est une fl√®che vers la droite,
        // passer directement au STEP2.
        if (window.innerWidth <= 600) {
          const icon = item.querySelector('i');
          if (item.classList.contains('selected-objective') && icon.classList.contains('fa-arrow-right')) {
            showBox(1, 2);
            return;
          }
        }

        // R√©initialiser la s√©lection sur tous les objectifs
        objectivesButtons.forEach(el => {
          el.classList.remove('selected-objective');
          const elIcon = el.querySelector('i');
          const cat = el.dataset.category;
          if (defaultIcons[cat]) {
            elIcon.className = defaultIcons[cat];
          }
          el.style.transform = "";
          el.style.backgroundColor = "";
        });

        // Marquer l‚Äôitem cliqu√© comme s√©lectionn√©
        item.classList.add('selected-objective');
        currentCategory = item.dataset.category;
        currentObjective = item.innerText;
        item.style.transition = "transform 0.3s, background-color 0.3s";
        item.style.transform = "scale(1.1)";
        item.style.backgroundColor = "rgba(0, 164, 138, 0.2)";
        setTimeout(() => { item.style.transform = ""; }, 300);

        // Affichage de l'explication et modification de l'ic√¥ne sur mobile
        if (window.innerWidth <= 600) {
          const existingExp = document.querySelector('.mobile-explanation');
          if (existingExp) { existingExp.remove(); }
          const exp = explanations[currentCategory] || "";
          if (exp) {
            item.insertAdjacentHTML('afterend', `<div class="mobile-explanation">${exp}</div>`);
          }
          // Modifier l'ic√¥ne en fl√®che vers la droite
          const icon = item.querySelector('i');
          icon.className = "fas fa-arrow-right";
        } else {
          const exp = explanations[currentCategory] || "";
          explanationBox.textContent = exp;
          explanationBox.classList.add('show');
        }
        if (subjectsCache[currentCategory] === null) {
          await loadSubjects(currentCategory);
        }
        document.getElementById('objective-error').style.display = 'none';
        document.getElementById('impro-error').style.display = 'none';
        removePulseFromAll();
        nextBtns[1].classList.add('pulse');
      });
    });

    async function loadSubjects(category) {
      const filePath = txtFilesByCategory[category];
      if (!filePath) return [];
      try {
        const response = await fetch(filePath);
        if (!response.ok) {
          console.error("Erreur fetch:", filePath);
          return [];
        }
        const text = await response.text();
        const lines = text.split('\n').map(l => l.trim()).filter(l => l.length > 0);
        subjectsCache[category] = lines;
        return lines;
      } catch (err) {
        console.error("Erreur fetch: ", err);
        return [];
      }
    }

    /***********************
     * GESTION DU SUJET D'IMPRO (STEP2)
     ***********************/
    const generateSubjectBtn = document.getElementById('generate-subject-btn');
    const subjectWrapper = document.getElementById('subject-wrapper');
    const subjectDisplay = document.getElementById('subject-display');

    generateSubjectBtn.addEventListener('click', () => {
      if (!currentCategory) {
        displayError('objective-error', "Merci de s√©lectionner un objectif avant de g√©n√©rer un sujet.");
        return;
      }
      const subjects = subjectsCache[currentCategory];
      if (!subjects || subjects.length === 0) {
        subjectDisplay.textContent = "D√©sol√©, aucun sujet n'est disponible pour le moment. Veuillez r√©essayer plus tard.";
        subjectWrapper.style.display = 'block';
        currentSubject = "";
        return;
      }
      const randomIndex = Math.floor(Math.random() * subjects.length);
      currentSubject = subjects[randomIndex];
      subjectDisplay.textContent = currentSubject;
      subjectWrapper.style.display = 'block';
      generateSubjectBtn.classList.add('subject-generated');
      document.getElementById('subject-error').style.display = 'none';
      removePulseFromAll();
      nextBtns[2].classList.add('pulse');
    });

    document.getElementById('advice-toggle').addEventListener('click', () => {
      const adviceText = document.getElementById('advice-text');
      const adviceIcon = document.getElementById('advice-icon');
      if (adviceText.style.display === 'none' || adviceText.style.display === '') {
        adviceText.style.display = 'block';
        adviceIcon.classList.remove('fa-chevron-down');
        adviceIcon.classList.add('fa-chevron-up');
        adviceIcon.style.transform = 'rotate(0deg)';
      } else {
        adviceText.style.display = 'none';
        adviceIcon.classList.remove('fa-chevron-up');
        adviceIcon.classList.add('fa-chevron-down');
        adviceIcon.style.transform = 'rotate(0deg)';
      }
    });

    /***********************
     * ENREGISTREMENT VID√âO (STEP3)
     ***********************/
    function bindStartButton() {
      const startBtn = document.getElementById('start-btn');
      if(startBtn){
        startBtn.addEventListener('click', startImpro);
      }
    }

    async function startImpro() {
      if (!currentSubject) {
        displayError('impro-error', "Tu dois g√©n√©rer un sujet avant de d√©marrer l'improvisation.");
        return;
      }
      if (typeof MediaRecorder === 'undefined' || !navigator.mediaDevices?.getUserMedia) {
        displayError('impro-error', "D√©sol√©, l'enregistrement vid√©o n'est pas support√© par votre navigateur.");
        return;
      }
      if (!confirm("Votre webcam va se lancer pour d√©marrer l'improvisation. Voulez-vous continuer ?")) {
        return;
      }
      if (window.innerWidth <= 600) {
          const videoBox = document.querySelector('.video-box');
          videoBox.style.height = "450px";
      }
      document.querySelector('.video-overlay').style.display = 'none';
      startInitialCountdown();
    }

    function startInitialCountdown() {
      let count = 5;
      document.getElementById('initial-countdown').textContent = count;
      document.getElementById('initial-countdown-overlay').style.display = 'flex';
      countdown = setInterval(() => {
        count--;
        if (count > 0) {
          document.getElementById('initial-countdown').textContent = count;
        } else {
          clearInterval(countdown);
          document.getElementById('initial-countdown-overlay').style.display = 'none';
          initiateRecording();
        }
      }, 1000);
    }

    async function initiateRecording() {
      const stream = await setupCamera();
      if (!stream) return;
      if (!window.MediaRecorder || typeof MediaRecorder.isTypeSupported === 'undefined') {
        displayError('impro-error', "Ton navigateur ne supporte pas l'enregistrement vid√©o. Essaye avec Chrome, Edge ou Firefox.");
        return;
      }
      mediaRecorderInstance = new MediaRecorder(stream);
      recordedChunks = [];
      mediaRecorderInstance.ondataavailable = (event) => {
        if (event.data.size > 0) {
          recordedChunks.push(event.data);
        }
      };
      mediaRecorderInstance.onstop = () => {
        const videoBlob = new Blob(recordedChunks, { type: 'video/mp4' });
        videoURL = URL.createObjectURL(videoBlob);
        stream.getTracks().forEach(t => t.stop());
        const overlay = document.querySelector('.video-overlay');
        overlay.innerHTML = "<p style='color: white; font-size: 18px; text-align: center;'>Improvisation termin√©e. <br>Passe √† l'√©tape suivante !</p>";
        overlay.style.display = 'flex';
        document.getElementById('impro-error').style.display = 'none';
        document.getElementById('recording-indicator').style.display = 'none';
        clearInterval(timerInterval);
        isImproRecordingStarted = true;
        removePulseFromAll();
        nextBtns[3].classList.add('pulse');
        enableNavigationButtons();
        if (window.innerWidth <= 600) {
            document.querySelector('.video-box').style.height = "300px";
        }
      };
      mediaRecorderInstance.start();
      document.getElementById('recording-indicator').style.display = 'flex';
      document.getElementById('stop-btn').classList.remove('hidden-btn');
      document.getElementById('stop-btn').disabled = false;
      document.getElementById('restart-btn').classList.add('hidden-btn');
      disableNavigationButtons();
      startTimer();
    }

    async function setupCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
        document.getElementById('preview').srcObject = stream;
        return stream;
      } catch (error) {
        if (error.name === 'NotAllowedError') {
          displayError('impro-error', "Vous avez refus√© l'acc√®s √† la webcam. Veuillez autoriser l'acc√®s.");
        } else if (error.name === 'NotFoundError') {
          displayError('impro-error', "Aucune cam√©ra/micro d√©tect√©s.");
        } else {
          displayError('impro-error', "Erreur : Impossible d'acc√©der √† la webcam.");
        }
        console.error(error);
        return null;
      }
    }

    function startTimer() {
      timeRemaining = 120;
      updateCountdownDisplay();
      timerInterval = setInterval(() => {
        timeRemaining--;
        if (timeRemaining >= 0) {
          updateCountdownDisplay();
        }
        if (timeRemaining < 0) {
          clearInterval(timerInterval);
          if (mediaRecorderInstance && mediaRecorderInstance.state === 'recording') {
            mediaRecorderInstance.stop();
            document.getElementById('restart-btn').classList.remove('hidden-btn');
          }
        }
      }, 1000);
    }
    function updateCountdownDisplay() {
      const minutes = Math.floor(timeRemaining / 60);
      const seconds = timeRemaining % 60;
      const countdownEl = document.getElementById('countdown');
      countdownEl.textContent = `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
      countdownEl.style.display = 'block';
    }

    document.getElementById('stop-btn').addEventListener('click', () => {
      if (mediaRecorderInstance && mediaRecorderInstance.state === 'recording') {
        mediaRecorderInstance.stop();
        clearInterval(countdown);
        clearInterval(timerInterval);
        document.getElementById('stop-btn').classList.add('hidden-btn');
        document.getElementById('stop-btn').disabled = true;
        document.getElementById('restart-btn').classList.remove('hidden-btn');
        document.getElementById('recording-indicator').style.display = 'none';
      }
    });
    document.getElementById('restart-btn').addEventListener('click', () => {
      document.getElementById('restart-btn').classList.add('hidden-btn');
      document.querySelector('.video-overlay').innerHTML = `
        <p>Ton improvisation vid√©o va s'enregistrer ici.</p>
        <button id="start-btn" aria-label="D√©marrer l'improvisation">
          D√©marrer ton impro <i class="fas fa-video"></i>
        </button>
        <p>NB : ta vid√©o est stock√©e sur ton appareil. Aucun enregistrement n'est conserv√© par Letmotiv.</p>
      `;
      document.querySelector('.video-overlay').style.display = 'flex';
      isImproRecordingStarted = false;
      bindStartButton();
    });
    bindStartButton();

    /***********************
     * T√âL√âCHARGEMENT & NEWSLETTER (STEP4)
     ***********************/
    // Gestion du t√©l√©chargement de la vid√©o
    document.getElementById('download-video-btn').addEventListener('click', () => {
      if (confirm("Une vid√©o va √™tre t√©l√©charg√©e. Voulez-vous continuer ?")) {
        if (videoURL) {
          const link = document.createElement('a');
          link.href = videoURL;
          link.download = 'Letmotiv_Improvisation.mp4';
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          videoDownloaded = true;  // Indique que la vid√©o a √©t√© t√©l√©charg√©e
          // On efface le message d'erreur si pr√©sent
          document.getElementById('action-error').style.display = 'none';
          // Ajoute l'animation sur le bouton "Analyse de la prestation"
          const feedbackBtn = document.getElementById('feedback-btn');
          feedbackBtn.classList.add('pulse');
        } else {
          alert("Aucune vid√©o n'est disponible pour le moment.");
        }
      }
    });

    // Gestion du bouton "Analyse de la prestation"
    document.getElementById('feedback-btn').addEventListener('click', () => {
      const errorEl = document.getElementById('action-error');
      errorEl.style.display = 'none';
      if (!videoDownloaded) {
        errorEl.textContent = "T√©l√©charge ta vid√©o avant de continuer.";
        errorEl.style.display = 'block';
      } else {
        window.location.href = "https://www.letmotiv.fr/simulateur-prise-de-parole-en-public/feedback-impro";
      }
    });

    // Gestion du bouton "Prendre rdv avec un expert"
    document.getElementById('contact-btn').addEventListener('click', () => {
      const errorEl = document.getElementById('action-error');
      errorEl.style.display = 'none';
      if (!videoDownloaded) {
        errorEl.textContent = "T√©l√©charge ta vid√©o avant de continuer.";
        errorEl.style.display = 'block';
      } else {
        // Navigue vers le STEP5 (Prise de contact Calendly)
        showBox(4, 5);
      }
    });

    // Gestion de la newsletter
    document.getElementById('newsletter-form').addEventListener('submit', (e) => {
      e.preventDefault();
      let valid = true;
      const prenomInput = document.getElementById('newsletter-prenom');
      const emailInput = document.getElementById('newsletter-email');
      const prenomErrorEl = document.getElementById('newsletter-prenom-error');
      const emailErrorEl = document.getElementById('newsletter-email-error');
      prenomErrorEl.style.display = 'none';
      emailErrorEl.style.display = 'none';

      if (prenomInput.value.trim() === "") {
        prenomErrorEl.textContent = "Le pr√©nom est requis.";
        prenomErrorEl.style.display = 'block';
        valid = false;
      }
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (emailInput.value.trim() === "") {
        emailErrorEl.textContent = "L'email est requis.";
        emailErrorEl.style.display = 'block';
        valid = false;
      } else if (!emailRegex.test(emailInput.value.trim())) {
        emailErrorEl.textContent = "L'email n'est pas valide.";
        emailErrorEl.style.display = 'block';
        valid = false;
      }
      if (!valid) return;

      // Envoi vers Google Forms (les champs cach√©s sont mis √† jour)
      document.getElementById('hidden-prenom').value = prenomInput.value.trim();
      document.getElementById('hidden-email').value = emailInput.value.trim();
      document.getElementById('hidden-google-form').submit();

      // Affichage du message de succ√®s sans popup
      const successEl = document.getElementById('newsletter-success');
      successEl.style.display = 'block';
      setTimeout(() => { successEl.style.display = 'none'; }, 5000);
    });

    /***********************
     * PARTAGE SUR LINKEDIN
     ***********************/
    document.getElementById("linkedin-share-btn").addEventListener("click", () => {
      const shareURL = encodeURIComponent(window.location.href);
      const linkedInURL = "https://www.linkedin.com/sharing/share-offsite/?url=" + shareURL;
      window.open(linkedInURL, '_blank');
    });

    initNavigationButtons();

    function disableNavigationButtons() {
      Object.values(nextBtns).forEach(btn => btn.disabled = true);
      Object.values(backBtns).forEach(btn => btn.disabled = true);
    }
    function enableNavigationButtons() {
      Object.values(nextBtns).forEach(btn => btn.disabled = false);
      Object.values(backBtns).forEach(btn => btn.disabled = false);
    }

    // Au chargement, v√©rifie le hash pour afficher l'√©tape correspondante
    document.addEventListener('DOMContentLoaded', () => {
      if (window.location.hash) {
        const stepFromHash = window.location.hash.replace('#step', '');
        if (boxes[stepFromHash]) {
          showBox(currentStep, stepFromHash);
        }
      }
    });
  </script>
</body>
</html>
