<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simulateur d'improvisation</title>
  <meta name="description" content="Évaluer et développer sa prise de parole en public avec le simulateur d'improvisation Letmotiv. Entreprise spécialisée dans le coaching en prise de parole.">

  <!-- Icône de la page (favicon) -->
  <link rel="icon" href="https://raw.githubusercontent.com/Citizen11bf/letmotiv/refs/heads/images/Letmotiv_favicon.webp" type="image/png">
  <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/Citizen11bf/letmotiv/refs/heads/images/Letmotiv_favicon.webp">
  
  <!-- Balises Open Graph -->
  <meta property="og:title" content="Simulateur d'improvisation Letmotiv" />
  <meta property="og:description" content="Évaluer et développer sa prise de parole en public avec le simulateur d'improvisation Letmotiv." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://letmotiv-simulateur.fr" />
  <meta property="og:image" content="https://i.postimg.cc/LXxJLTVx/Letmotiv-og-image.png" />
  <meta property="og:image:alt" content="Illustration d'une improvisation en public avec un orateur sur scène." />
  <meta name="author" content="Simulateur d'improvisation Letmotiv" />
  <meta property="article:published_time" content="2025-01-26" />

  <!-- Balises Twitter (optionnel) -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Simulateur d'improvisation Letmotiv">
  <meta name="twitter:description" content="Évaluer et développer sa prise de parole en public avec le simulateur d'improvisation Letmotiv.">
  <meta name="twitter:image" content="https://i.postimg.cc/LXxJLTVx/Letmotiv-og-image.png">

  <!-- Polices Google -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans&family=Montserrat:wght@700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Poppins:900i" rel="stylesheet">
  
  <!-- Icônes Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

  <!-- Calendly widget CSS -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">

  <!-- JSON-LD pour le SEO -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Simulateur d'improvisation Letmotiv",
      "url": "https://letmotiv-simulateur.fr",
      "description": "Évaluer et développer sa prise de parole en public avec le simulateur d'improvisation Letmotiv.",
      "publisher": {
        "@type": "Organization",
        "name": "Letmotiv",
        "logo": "https://letmotiv-simulateur.fr/logo.png"
      }
    }
  </script>
  
  <style>
    /* --- GLOBAL --- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'DM Sans', sans-serif;
      background-color: #ffffff;
      color: #333333;
      padding-top: 60px;
      padding-bottom: 20px;
    }
    .error-message {
      color: red;
      font-size: 14px;
      margin-top: 5px;
    }

    /* --- HEADER --- */
    .header {
      background-color: #182d84;
      color: #FFFFFF;
      font-size: 16px;
      font-weight: bold;
      text-align: center;
      padding: 10px;
      width: 100%;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 10;
    }
    .header-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      max-width: 100%;
      overflow-wrap: break-word;
    }
    .header-l2 { font-size: 14px; font-weight: normal; }

    /* --- BARRE DE PROGRESSION --- */
    .progress-container {
      position: fixed;
      top: 60px;
      left: 0;
      width: 100%;
      height: 10px;
      background-color: rgba(24, 45, 132, 0.1);
      z-index: 9;
    }
    .progress-bar {
      width: 0%;
      height: 100%;
      background-color: #00a48a;
      transition: width 0.5s ease;
    }

    /* --- INTRO BOX --- */
    .intro-box {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(135deg, #182d84, #00a48a);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #ffffff;
      z-index: 20;
      animation: fadeIn 1s ease forwards;
    }
    .intro-box h1 {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.8rem;
      margin-bottom: 50px;
      animation: slideDown 1s ease forwards;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
    }
    .intro-box h1 span { display: block; }
    .wrapper { display: flex; justify-content: center; }

    .cta {
      display: flex;
      padding: 10px 45px;
      text-decoration: none;
      font-family: 'Poppins', sans-serif;
      font-size: 40px;
      color: white;
      background: #FF5722;
      transition: 0.5s;
      box-shadow: 6px 6px 0 black;
      transform: skewX(-15deg);
      border-radius: 8px;
    }
    .cta:focus { outline: none; }
    .cta:hover { transition: 0.3s; box-shadow: 10px 10px 0 #FBC638; }
    .cta span:nth-child(2) { transition: 0.3s; margin-right: 0px; }
    .cta:hover span:nth-child(2) { transition: 0.3s; margin-right: 45px; }
    .cta span { transform: skewX(15deg); }
    .cta span:nth-child(2) {
      width: 20px;
      margin-left: 30px;
      position: relative;
      top: 12%;
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
    @keyframes slideDown { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    /* --- MAIN CONTAINER --- */
    .main-container {
      position: relative;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    /* --- BOXES (étapes) --- */
    .box {
      position: relative;
      width: 100%;
      margin: 20px auto;
      padding: 20px;
      border-radius: 15px;
      background: linear-gradient(135deg, #ffffff, #f9f9f9);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
      font-size: 14px;
      display: none;
      transition: opacity 0.5s ease;
    }
    .box.active { display: block; opacity: 1; }
    .box.hidden { opacity: 0; }

    /* Animations */
    .slide-from-bottom { animation: fromBottom 1.5s ease forwards; }
    @keyframes fromBottom {
      from { opacity: 0; transform: translateY(50px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .slide-from-top { animation: fromTop 1.5s ease forwards; }
    @keyframes fromTop {
      from { opacity: 0; transform: translateY(-50px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* --- BOX HEADER --- */
    .box-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      position: relative;
    }
    .back-btn {
      border: none;
      background-color: #808080;
      color: #FFFFFF;
      font-size: 16px;
      cursor: pointer;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s, transform 0.3s;
      margin: 0 auto 10px;
    }
    .back-btn:hover { background-color: #505050; transform: scale(1.1); }
    .back-btn:active { background-color: #303030; }
    #step1 .back-btn.hidden-visibility { display: none; }
    .box-title {
      font-size: 16px;
      font-weight: bold;
      color: #182d84;
      text-align: center;
    }

    /* --- NAV BOUTONS (flèches) --- */
    .next-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #182d84;
      background-color: transparent;
      color: #182d84;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s, transform 0.3s;
      margin: 10px auto;
    }
    .next-btn:hover {
      background-color: #00a48a;
      color: #ffffff;
      transform: scale(1.05);
    }
    .next-btn.pulse { animation: electricPulse 1.5s infinite; }
    @keyframes electricPulse {
      0% { box-shadow: 0 0 0 0 rgba(0,164,138,0.7); }
      70%{ box-shadow: 0 0 0 10px rgba(0,164,138,0); }
      100%{ box-shadow: 0 0 0 0 rgba(0,164,138,0); }
    }

    /* Bouton principal (Impros, etc.) */
    .btn-impro {
      margin: 15px 0;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .btn-impro:hover {
      background-color: #00a48a;
    }

    /* --- STEP1 : Choix d’objectif --- */
    .objectives-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
      justify-items: center;
      margin: 10px 0;
    }
    .objective-item {
      text-align: center;
      color: #444;
      font-size: 0.9rem;
      cursor: pointer;
      padding: 12px;
      border: 1px solid transparent;
      border-radius: 10px;
      transition: background-color 0.3s, border-color 0.3s, transform 0.3s;
    }
    .objective-item i {
      font-size: 1.8rem;
      margin-bottom: 8px;
      display: block;
    }
    .objective-item i.fa-arrow-right { transform: none !important; }
    .objective-item:hover {
      border-color: #00a48a;
      background-color: rgba(0, 164, 138, 0.1);
    }
    .objective-item.selected-objective {
      transform: scale(1.1);
      background-color: rgba(0, 164, 138, 0.2);
      color: #00a48a;
      border-color: #00a48a;
      transition: all 0.3s ease-in-out;
    }
    .objective-item.selected-objective i { color: #00a48a; }

    /* Couleurs d'icônes */
    .objective-item[data-category="convaincre"] i { color: #007BFF; }
    .objective-item[data-category="inspirer"]   i { color: #FFC107; }
    .objective-item[data-category="toast"]      i { color: #E91E63; }
    .objective-item[data-category="repartie"]   i { color: #9C27B0; }
    .objective-item[data-category="vendre"]     i { color: #4CAF50; }
    .objective-item[data-category="conflit"]    i { color: #F44336; }
    .objective-item[data-category="diction"]    i { color: #00BCD4; }
    .objective-item[data-category="entretien"]  i { color: #795548; }
    .objective-item[data-category="lacher-prise"] i { color: #FF5722; }

    /* --- STEP2 : Génération du sujet --- */
    #subject-wrapper {
      margin-top: 10px;
      background: linear-gradient(135deg, #00a48a, #182d84);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      font-size: 16px;
      font-weight: normal;
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      display: none;
    }
    #advice-toggle {
      cursor: pointer;
      margin-top: 20px;
      margin-bottom: 20px;
      text-align: center;
      font-weight: normal;
      color: #182d84;
    }
    #advice-toggle i {
      margin-left: 5px;
      transition: transform 0.3s ease;
    }
    #advice-text {
      display: none;
      margin-top: 10px;
      padding: 10px;
      background-color: #fefefe;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.5;
      text-align: left;
    }
    .mobile-break { display: none; }
    @media (max-width: 600px) {
      .mobile-break { display: inline; }
    }

    /* --- STEP3 : Enregistrement vidéo --- */
    .subject-bubble {
      display: inline-block;
      position: relative;
      background: #fefefe;
      border: 2px solid #ccc;
      border-radius: 16px;
      padding: 10px 10px;
      font-size: 14px;
      color: #333;
      text-align: center;
      margin: 0 auto;
      max-width: 90%;
    }
    .video-box {
      margin: 10px auto;
      border: 3px solid #182d84;
      border-radius: 6px;
      max-width: 500px;
      background-color: #fefefe;
      height: 300px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      transition: height 0.5s ease-in-out;
    }
    .video-box video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 4px;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
      transform: scaleX(-1);
      -webkit-transform: scaleX(-1);
    }
    .video-overlay {
      position: absolute;
      z-index: 2;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: #555;
      font-style: italic;
      font-size: 14px;
      padding: 20px;
      background: rgba(255,255,255,0.6);
    }
    .video-overlay p { margin: 10px 0; }
    .video-overlay button {
      margin: 15px 0;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #182d84;
      color: #fff;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .video-overlay button:hover {
      background-color: #00a48a;
    }
    .recording-indicator {
      display: none;
      flex-direction: row;
      align-items: center;
      gap: 5px;
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: rgba(128,128,128,0.6);
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 14px;
      color: #ff0000;
      z-index: 3;
    }
    .recording-indicator .dot {
      height: 10px;
      width: 10px;
      background-color: #ff0000;
      border-radius: 50%;
      display: inline-block;
      animation: blink 1s infinite;
    }
    .countdown {
      font-size: 16px;
      color: #ffffff;
      background: none;
      margin-left: 5px;
    }
    .initial-countdown-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(128,128,128,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 5;
      border-radius: 6px;
    }
    .initial-countdown {
      font-size: 48px;
      color: #ffffff;
      font-weight: bold;
    }
    .impro-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 10px;
    }
    .hidden-btn { display: none; }

    /* --- STEP4 : Bilan - Téléchargement, Analyse & Prise de rendez-vous --- */
    #step4 .download-section-accent {
      background: linear-gradient(135deg, #182d84, #00a48a);
      padding: 15px 30px;
      border-radius: 12px;
      color: #fff;
      margin-bottom: 20px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      font-size: 0.8rem;
    }
    #step4 .download-section-accent h2 {
      font-weight: bold;
      margin: 0;
      font-size: 1.2rem;
    }

    /* --- NOUVEAU DESIGN STEP4 (Desktop vs Mobile) --- */
    .action-container {
      display: flex;
      gap: 10px;
      /* Sur desktop, on veut 3 boutons sur une seule ligne */
      flex-wrap: nowrap;
    }
    /* Sur mobile, on empile en colonne */
    @media (max-width: 600px) {
      .action-container {
        flex-direction: column;
      }
    }

    .action-square {
      background-color: #FF5722;
      color: #fff;
      border-radius: 6px;
      padding: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex: 1;
      text-decoration: none;
      font-size: 16px;
      font-weight: normal;
      transition: background-color 0.3s, color 0.3s;
    }
    .action-square:hover {
      background-color: #FBC638;
      color: #000;
    }
    .action-square.disabled {
      opacity: 0.5;
      pointer-events: none;
    }

    /* Pour le texte à gauche (ex: "1) Télécharge ta vidéo") */
    .action-square .label {
      margin-right: 10px;
      text-align: left;
      flex: 1;
    }

    /* Bouton contact => on peut en faire un <div> ou un <a> 
       ici on le laisse en <div> pour éviter l'effet clic-lien
    */
    #contact-btn {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
    }
    #contact-btn .contact-options {
      display: flex;
      gap: 8px;
      flex-shrink: 0; /* Pour éviter que les boutons rapetissent */
    }

    /* Boutons Oui / Non */
    #contact-btn .contact-options button {
      background-color: #fff;
      color: #FF5722;
      border: 1px solid #FF5722;
      border-radius: 4px;
      font-size: 14px;
      padding: 4px 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    #contact-btn .contact-options button:hover {
      background-color: #FF5722;
      color: #fff;
    }

    /* Sur mobile, on empile la question et les boutons Oui/Non */
    @media (max-width: 600px) {
      #contact-btn {
        flex-direction: column;
        align-items: flex-start;
      }
      #contact-btn .contact-options {
        margin-top: 8px;
      }
    }

    /* --- STEP4 - Newsletter --- */
    .newsletter-container {
      width: 100%;
      max-width: 600px;
      background-color: #2d3748;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      padding: 20px;
      margin: 30px auto;
      color: #e2e8f0;
      text-align: center;
    }
    .newsletter-title {
      font-size: 1.0rem;
      font-weight: normal;
      margin-bottom: 20px;
    }
    .newsletter-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .newsletter-form input::placeholder {
      color: #fff;
    }
    .newsletter-form input {
      background-color: #4a5568;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px;
      outline: none;
      transition: background-color 0.3s, box-shadow 0.3s;
    }
    .newsletter-form input:focus {
      background-color: #2d3748;
      box-shadow: 0 0 0 1px #3182ce;
    }
    .newsletter-error {
      color: red;
      font-size: 0.8rem;
      text-align: left;
    }
    .newsletter-success {
      color: green;
      font-size: 0.9rem;
      margin-top: 10px;
    }
    .btn-newsletter {
      background: linear-gradient(135deg, #182d84, #00a48a);
      color: #fff;
      font-weight: bold;
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      margin: 10px 0;
    }
    .btn-newsletter:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }

    /* --- STEP5 : Calendly --- */
    .calendy { text-align: center; }
    .calendy .container { padding: 10px 0; }

    /* --- BOUTON DE PARTAGE GLOBAL --- */
    #global-share-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #2E22AC;
      color: #fff;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 10000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      transition: background-color 0.3s;
      display: none;
      flex-direction: column;
    }
    #global-share-btn:hover {
      background-color: #00a48a;
    }

  </style>
</head>
<body>
  <!-- BOÎTE D'INTRODUCTION -->
  <div class="intro-box" id="intro-box">
    <h1>
      <span class="line">ENTRAINE-TOI</span>
      <span class="line">A LA PRISE DE PAROLE</span>
      <span class="line">EN PUBLIC</span>
    </h1>
    <div class="wrapper">
      <a id="start-intro-btn" class="cta" href="#">
        <span>COMMENCER</span>
        <span>
          <!-- Petite flèche décorative -->
          <svg width="66px" height="43px" viewBox="0 0 66 43" version="1.1" xmlns="http://www.w3.org/2000/svg">
            <g id="arrow" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <path class="one" d="M40.1543933,3.89485454 L43.9763149,0.139296592..." fill="#FFFFFF"></path>
              <path class="two" d="M20.1543933,3.89485454 L23.9763149,0.139296592..." fill="#FFFFFF"></path>
              <path class="three" d="M0.154393339,3.89485454 L3.97631488,0.139296592..." fill="#FFFFFF"></path>
            </g>
          </svg>
        </span>
      </a>
    </div>
  </div>

  <!-- FORMULAIRE CACHÉ POUR GOOGLE FORMS -->
  <form id="hidden-google-form"
        action="https://docs.google.com/forms/d/e/1FAIpQLSfGAcKp0cV5AeVJCJBPbtKLKCLhbYySZf_FkiMg85WKVFUn6A/formResponse"
        method="POST"
        target="hidden_iframe"
        style="display:none;">
    <input type="text" name="entry.1119647353" id="hidden-prenom">
    <input type="email" name="entry.638831312" id="hidden-email">
  </form>
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

  <!-- HEADER -->
  <div class="header">
    <div class="header-content">
      <div class="header-l1">Coaching en prise de parole</div>
      <div class="header-l2">Simulateur d'improvisation Letmotiv</div>
    </div>
  </div>

  <!-- BARRE DE PROGRESSION -->
  <div class="progress-container">
    <div class="progress-bar" id="top-progress-bar"></div>
  </div>

  <!-- CONTENU PRINCIPAL -->
  <div class="main-container">

    <!-- STEP1 : Choix d'objectif -->
    <div class="box" id="step1">
      <div class="box-header">
        <button class="back-btn hidden-visibility" id="back-btn1" aria-label="Retour">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Quel est ton objectif ?</div>
      </div>
      <div class="objectives-container">
        <div class="objective-item" data-category="diction">
          <i class="fas fa-grin-tongue"></i>
          <span>Améliorer sa diction</span>
        </div>
        <div class="objective-item" data-category="repartie">
          <i class="fas fa-comments"></i>
          <span>Avoir de la répartie</span>
        </div>
        <div class="objective-item" data-category="convaincre">
          <i class="fas fa-handshake"></i>
          <span>Convaincre</span>
        </div>
        <div class="objective-item" data-category="conflit">
          <i class="fas fa-exclamation-triangle"></i>
          <span>Gérer un conflit</span>
        </div>
        <div class="objective-item" data-category="inspirer">
          <i class="fas fa-lightbulb"></i>
          <span>Inspirer</span>
        </div>
        <div class="objective-item" data-category="lacher-prise">
          <i class="fas fa-smile"></i>
          <span>Lâcher prise</span>
        </div>
        <div class="objective-item" data-category="toast">
          <i class="fas fa-glass-cheers"></i>
          <span>Porter un toast</span>
        </div>
        <div class="objective-item" data-category="entretien">
          <i class="fas fa-briefcase"></i>
          <span>Réussir son entretien</span>
        </div>
        <div class="objective-item" data-category="vendre">
          <i class="fas fa-money-bill-wave"></i>
          <span>Vendre</span>
        </div>
      </div>
      <div id="explanation-box" class="explanation-box"></div>
      <div id="objective-error" class="error-message"></div>
      <button class="next-btn" id="next-btn1" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP2 : Génération du sujet -->
    <div class="box" id="step2">
      <div class="box-header">
        <button class="back-btn" id="back-btn2" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Prêt à relever le défi ?</div>
      </div>
      <button id="generate-subject-btn" class="btn-impro">Générer un sujet <i class="fas fa-random"></i></button>
      <div id="subject-wrapper">
        <span id="subject-display"></span>
      </div>
      <div id="advice-toggle">
        Des conseils avant de démarrer<span class="mobile-break"><br></span> ta simulation ?
        <i id="advice-icon" class="fas fa-chevron-down"></i>
      </div>
      <div id="advice-text">
        1) Positionne tes yeux à hauteur de la caméra. <br><br>
        2) Choisis un fond neutre pour éviter toute distraction.<br><br>
        3) Assure-toi que l'éclairage te met en valeur. <br><br>
        4) Vérifie que le son et la vidéo fonctionnent.<br><br>
        5) Reste concentré et prends du plaisir. 
      </div>
      <div id="subject-error" class="error-message"></div>
      <button class="next-btn" id="next-btn2" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP3 : Enregistrement vidéo -->
    <div class="box" id="step3">
      <div class="box-header">
        <button class="back-btn" id="back-btn3" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">C'est parti, lance ton improvisation !</div>
      </div>
      <div id="current-subject-display" class="subject-bubble"></div>
      <div class="video-box">
        <video id="preview" autoplay muted playsinline webkit-playsinline></video>
        <div class="video-overlay">
          <p>Ta vidéo va s'enregistrer ici.</p>
          <button id="start-btn" aria-label="Démarrer l'improvisation">
            Démarrer ton impro <i class="fas fa-video"></i>
          </button>
          <p>NB : ta vidéo est stockée sur ton appareil. Aucun enregistrement n'est conservé par Letmotiv.</p>
        </div>
        <div class="recording-indicator" id="recording-indicator">
          <span class="dot"></span>
          <div class="countdown" id="countdown">1:59</div>
        </div>
        <div class="initial-countdown-overlay" id="initial-countdown-overlay">
          <div class="initial-countdown" id="initial-countdown">3</div>
        </div>
      </div>
      <div class="impro-actions">
        <button id="stop-btn" class="hidden-btn btn-impro" aria-label="Arrêter l'improvisation">
          Arrêter ton impro <i class="fas fa-stop"></i>
        </button>
        <button id="restart-btn" class="hidden-btn btn-impro" aria-label="Recommencer l'improvisation">
          Recommencer ton impro <i class="fas fa-redo"></i>
        </button>
      </div>
      <div id="impro-error" class="error-message"></div>
      <button class="next-btn" id="next-btn3" aria-label="Étape suivante">
        <i class="fas fa-arrow-down"></i>
      </button>
    </div>

    <!-- STEP4 : Bilan - Téléchargement, Analyse & Prise de rendez-vous -->
    <div class="box" id="step4">
      <div class="box-header">
        <button class="back-btn" id="back-btn4" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">C'est l'heure du bilan !</div>
      </div>
      <div class="download-section">
        <!-- Message de félicitations -->
        <div class="download-section-accent">
          <h2>Félicitations pour ton improvisation ! <span>🤩</span></h2>
        </div>

        <!-- 3 actions STEP4 (desktop: horizontales, mobile: verticales) -->
        <div class="action-container">
          <!-- 1) Télécharger la vidéo -->
          <a id="download-video-btn" class="action-square" aria-label="Télécharge ta vidéo">
            <span class="label">1) Télécharge ta vidéo</span>
          </a>

          <!-- 2) Prendre rdv avec un expert -->
          <div id="contact-btn" class="action-square disabled" aria-label="Prendre rdv avec un expert">
            <span class="label">2) Tu veux prendre rdv avec un expert ?</span>
            <div class="contact-options">
              <button id="contact-yes">Oui <i class="fas fa-check"></i></button>
              <button id="contact-no">Non <i class="fas fa-times"></i></button>
            </div>
          </div>

          <!-- 3) Analyser la prestation -->
          <a id="feedback-btn" class="action-square disabled" aria-label="Analyse ta prestation">
            <span class="label">3) Analyse ta prestation</span>
          </a>
        </div>
        
        <!-- Newsletter -->
        <div class="newsletter-container">
          <h2 class="newsletter-title">Inscris-toi à la newsletter Letmotiv<br>pour progresser et prendre la parole avec impact :</h2>
          <form id="newsletter-form" class="newsletter-form">
            <input type="text" id="newsletter-prenom" placeholder="Prénom" aria-label="Prénom">
            <div id="newsletter-prenom-error" class="newsletter-error"></div>
            <input type="email" id="newsletter-email" placeholder="Votre email" aria-label="Email">
            <div id="newsletter-email-error" class="newsletter-error"></div>
            <button type="submit" id="newsletter-submit-btn" class="btn-newsletter">S'abonner</button>
          </form>
          <div id="newsletter-success" class="newsletter-success" style="display: none;">
            Tu es maintenant abonné à la newsletter Letmotiv.
          </div>
        </div>
      </div>
    </div>

    <!-- STEP5 : Calendly -->
    <div class="box" id="step5">
      <div class="box-header">
        <button class="back-btn" id="back-btn5" aria-label="Retour à l'étape précédente">
          <i class="fas fa-arrow-up"></i>
        </button>
        <div class="box-title">Planifiez un appel avec nous</div>
      </div>
      <main>
        <section id="calendy" class="section calendy">
          <div class="container">
            <!-- Calendly inline widget -->
            <div class="calendly-inline-widget"
                 data-url="https://calendly.com/letmotiv/premier-contact?hide_event_type_details=1"
                 style="min-width:320px;height:1000px;">
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <!-- Bouton de partage global (affiché seulement à partir du STEP1) -->
  <div id="global-share-btn">
    <i class="fas fa-share-alt"></i>
  </div>

  <!-- Calendly widget script -->
  <script src="https://assets.calendly.com/assets/external/widget.js" async></script>

  <script>
    /***********************
     * VARIABLES GLOBALES
     ***********************/
    const boxes = {
      1: document.getElementById('step1'),
      2: document.getElementById('step2'),
      3: document.getElementById('step3'),
      4: document.getElementById('step4'),
      5: document.getElementById('step5')
    };
    const nextBtns = {
      1: document.getElementById('next-btn1'),
      2: document.getElementById('next-btn2'),
      3: document.getElementById('next-btn3')
    };
    const backBtns = {
      2: document.getElementById('back-btn2'),
      3: document.getElementById('back-btn3'),
      4: document.getElementById('back-btn4'),
      5: document.getElementById('back-btn5')
    };
    const introBox = document.getElementById('intro-box');
    const startIntroBtn = document.getElementById('start-intro-btn');
    const topProgressBar = document.getElementById('top-progress-bar');

    let currentStep = 0;
    let currentCategory = null;
    let currentSubject = "";
    let isImproRecordingStarted = false;
    let mediaRecorderInstance;
    let recordedChunks = [];
    let videoURL = "";
    let timerInterval;
    let timeRemaining = 120;
    let countdown;
    let videoDownloaded = false;

    /***********************
     * HISTORIQUE NAVIGATION
     ***********************/
    function pushStepState(step) {
      history.pushState({ step }, null, `#step${step}`);
    }
    window.addEventListener('popstate', (event) => {
      if (event.state && event.state.step) {
        const stepToShow = event.state.step;
        Object.values(boxes).forEach(box => box.classList.remove('active'));
        boxes[stepToShow].classList.add('active');
        currentStep = stepToShow;
        updateProgressBar(stepToShow);
        updateShareButtonVisibility();
        if (stepToShow === 3) {
          document.getElementById('current-subject-display').textContent = currentSubject;
        }
      } else {
        Object.values(boxes).forEach(box => box.classList.remove('active'));
        introBox.style.display = 'block';
        currentStep = 0;
        updateShareButtonVisibility();
      }
    });

    /***********************
     * FONCTIONS UTILES
     ***********************/
    function updateProgressBar(step) {
      const progress = (step / 5) * 100;
      topProgressBar.style.width = `${progress}%`;
    }
    function displayError(elementId, message) {
      const el = document.getElementById(elementId);
      el.textContent = message;
      el.style.display = 'block';
    }
    function updateShareButtonVisibility() {
      const shareBtn = document.getElementById('global-share-btn');
      shareBtn.style.display = (currentStep >= 1) ? 'flex' : 'none';
    }
    function disableNavigationButtons() {
      Object.values(nextBtns).forEach(btn => btn.disabled = true);
      Object.values(backBtns).forEach(btn => btn.disabled = true);
    }
    function enableNavigationButtons() {
      Object.values(nextBtns).forEach(btn => btn.disabled = false);
      Object.values(backBtns).forEach(btn => btn.disabled = false);
    }

    /***********************
     * INTRO
     ***********************/
    startIntroBtn.addEventListener('click', () => {
      introBox.style.animation = 'fadeOut 0.5s ease forwards';
      setTimeout(() => {
        introBox.style.display = 'none';
        boxes[1].classList.add('active', 'slide-from-bottom');
        currentStep = 1;
        updateProgressBar(1);
        pushStepState(1);
        updateShareButtonVisibility();
      }, 500);
    });

    /***********************
     * STEP1 : Objectifs
     ***********************/
    const explanations = {
      convaincre:   "Tu as 2 minutes pour convaincre ton auditoire sur un sujet délicat",
      inspirer:     "Tu as 2 minutes pour inspirer ton auditoire",
      toast:        "Tu as 2 minutes pour porter un toast marquant lors d'un événement",
      repartie:     "Savoir répondre avec justesse et rapidité à une remarque désagréable au travail",
      vendre:       "Tu as 2 minutes pour vendre un objet insolite",
      conflit:      "Gère un désaccord ou une tension avec diplomatie",
      diction:      "Répète une phrase complexe plusieurs fois de suite sans te tromper",
      entretien:    "Convaincs ton futur employeur que tu es la pépite qu'il recherche",
      'lacher-prise': "Oublie la censure et exprime ton grain de folie"
    };
    const txtFilesByCategory = {
      convaincre:    "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/convaincre.txt",
      inspirer:      "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/inspirer.txt",
      'lacher-prise':"https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/lacher_prise.txt",
      toast:         "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/toast.txt",
      repartie:      "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/repartie.txt",
      vendre:        "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/vendre.txt",
      conflit:       "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/gerer_un_conflit.txt",
      diction:       "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/diction.txt",
      entretien:     "https://raw.githubusercontent.com/Citizen11bf/letmotiv/data/entretien.txt"
    };
    let subjectsCache = {
      convaincre: null, inspirer: null, 'lacher-prise': null,
      toast: null, repartie: null, vendre: null,
      conflit: null, diction: null, entretien: null
    };

    const objectivesButtons = document.querySelectorAll('.objectives-container .objective-item');
    const explanationBox = document.getElementById('explanation-box');

    objectivesButtons.forEach(item => {
      item.addEventListener('click', async () => {
        // Sur mobile : si déjà sélectionné, on passe direct au step2
        if (window.innerWidth <= 600) {
          const icon = item.querySelector('i');
          if (item.classList.contains('selected-objective') && icon.classList.contains('fa-arrow-right')) {
            showBox(1, 2);
            return;
          }
        }
        // Réinitialiser
        objectivesButtons.forEach(el => {
          el.classList.remove('selected-objective');
          el.style.transform = "";
          el.style.backgroundColor = "";
        });
        item.classList.add('selected-objective');
        const cat = item.dataset.category;
        currentCategory = cat;

        // Animation simple
        item.style.transition = "transform 0.3s, background-color 0.3s";
        item.style.transform = "scale(1.1)";
        item.style.backgroundColor = "rgba(0, 164, 138, 0.2)";
        setTimeout(() => { item.style.transform = ""; }, 300);

        // Explication
        if (window.innerWidth <= 600) {
          const existingExp = document.querySelector('.mobile-explanation');
          if(existingExp) { existingExp.remove(); }
          const exp = explanations[cat] || "";
          if(exp) {
            item.insertAdjacentHTML('afterend', `<div class="mobile-explanation">${exp}</div>`);
          }
          const icon = item.querySelector('i');
          icon.className = "fas fa-arrow-right";
        } else {
          explanationBox.textContent = explanations[cat] || "";
          explanationBox.classList.add('show');
        }
        if (subjectsCache[cat] === null) {
          await loadSubjects(cat);
        }
        document.getElementById('objective-error').style.display = 'none';
        document.getElementById('impro-error').style.display = 'none';
        nextBtns[1].classList.add('pulse');
      });
    });

    async function loadSubjects(category) {
      const filePath = txtFilesByCategory[category];
      if (!filePath) return [];
      try {
        const response = await fetch(filePath);
        if (!response.ok) {
          console.error("Erreur fetch:", filePath);
          return [];
        }
        const text = await response.text();
        const lines = text.split('\n').map(l => l.trim()).filter(l => l.length > 0);
        subjectsCache[category] = lines;
        return lines;
      } catch (err) {
        console.error("Erreur fetch: ", err);
        return [];
      }
    }

    /***********************
     * STEP2 : Génération du sujet
     ***********************/
    const generateSubjectBtn = document.getElementById('generate-subject-btn');
    const subjectWrapper = document.getElementById('subject-wrapper');
    const subjectDisplay = document.getElementById('subject-display');

    generateSubjectBtn.addEventListener('click', () => {
      if (!currentCategory) {
        displayError('objective-error', "Merci de sélectionner un objectif avant de générer un sujet.");
        return;
      }
      const subjects = subjectsCache[currentCategory];
      if (!subjects || subjects.length === 0) {
        subjectDisplay.textContent = "Désolé, aucun sujet n'est disponible pour le moment. Réessaie plus tard.";
        subjectWrapper.style.display = 'block';
        currentSubject = "";
        return;
      }
      const randomIndex = Math.floor(Math.random() * subjects.length);
      currentSubject = subjects[randomIndex];
      subjectDisplay.textContent = currentSubject;
      subjectWrapper.style.display = 'block';
      generateSubjectBtn.classList.add('subject-generated');
      document.getElementById('subject-error').style.display = 'none';
      nextBtns[2].classList.add('pulse');
    });

    document.getElementById('advice-toggle').addEventListener('click', () => {
      const adviceText = document.getElementById('advice-text');
      const adviceIcon = document.getElementById('advice-icon');
      if (adviceText.style.display === 'none' || adviceText.style.display === '') {
        adviceText.style.display = 'block';
        adviceIcon.classList.remove('fa-chevron-down');
        adviceIcon.classList.add('fa-chevron-up');
      } else {
        adviceText.style.display = 'none';
        adviceIcon.classList.remove('fa-chevron-up');
        adviceIcon.classList.add('fa-chevron-down');
      }
    });

    /***********************
     * STEP3 : Enregistrement vidéo
     ***********************/
    function bindStartButton() {
      const startBtn = document.getElementById('start-btn');
      if(startBtn) {
        startBtn.addEventListener('click', startImpro);
      }
    }
    async function startImpro() {
      if (!currentSubject) {
        displayError('impro-error', "Tu dois générer un sujet avant de démarrer l'improvisation.");
        return;
      }
      if (typeof MediaRecorder === 'undefined' || !navigator.mediaDevices?.getUserMedia) {
        displayError('impro-error', "L'enregistrement vidéo n'est pas supporté par votre navigateur.");
        return;
      }
      if (!confirm("Votre webcam va se lancer pour démarrer l'improvisation. Continuer ?")) {
        return;
      }
      if (window.innerWidth <= 600) {
        document.querySelector('.video-box').style.height = "450px";
      }
      document.querySelector('.video-overlay').style.display = 'none';
      startInitialCountdown();
    }
    function startInitialCountdown() {
      let count = 5;
      document.getElementById('initial-countdown').textContent = count;
      document.getElementById('initial-countdown-overlay').style.display = 'flex';
      countdown = setInterval(() => {
        count--;
        if (count > 0) {
          document.getElementById('initial-countdown').textContent = count;
        } else {
          clearInterval(countdown);
          document.getElementById('initial-countdown-overlay').style.display = 'none';
          initiateRecording();
        }
      }, 1000);
    }
    async function initiateRecording() {
      const stream = await setupCamera();
      if (!stream) return;
      if (!window.MediaRecorder || typeof MediaRecorder.isTypeSupported === 'undefined') {
        displayError('impro-error', "Ton navigateur ne supporte pas l'enregistrement vidéo.");
        return;
      }
      mediaRecorderInstance = new MediaRecorder(stream);
      recordedChunks = [];
      mediaRecorderInstance.ondataavailable = (event) => {
        if (event.data.size > 0) {
          recordedChunks.push(event.data);
        }
      };
      mediaRecorderInstance.onstop = () => {
        const videoBlob = new Blob(recordedChunks, { type: 'video/mp4' });
        videoURL = URL.createObjectURL(videoBlob);
        stream.getTracks().forEach(t => t.stop());
        const overlay = document.querySelector('.video-overlay');
        overlay.innerHTML = "<p style='color: white; font-size: 18px; text-align: center;'>Improvisation terminée.<br>Passe à l'étape suivante !</p>";
        overlay.style.display = 'flex';
        document.getElementById('impro-error').style.display = 'none';
        clearInterval(timerInterval);
        // Masquer l'indicateur d'enregistrement
        document.getElementById('recording-indicator').style.display = 'none';
        isImproRecordingStarted = true;
        nextBtns[3].classList.add('pulse');
        enableNavigationButtons();
        if (window.innerWidth <= 600) {
          document.querySelector('.video-box').style.height = "300px";
        }
      };
      mediaRecorderInstance.start();
      document.getElementById('recording-indicator').style.display = 'flex';
      document.getElementById('stop-btn').classList.remove('hidden-btn');
      document.getElementById('stop-btn').disabled = false;
      document.getElementById('restart-btn').classList.add('hidden-btn');
      disableNavigationButtons();
      startTimer();
    }
    async function setupCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
        document.getElementById('preview').srcObject = stream;
        return stream;
      } catch (error) {
        if (error.name === 'NotAllowedError') {
          displayError('impro-error', "Accès à la webcam refusé.");
        } else if (error.name === 'NotFoundError') {
          displayError('impro-error', "Aucune caméra/micro détectés.");
        } else {
          displayError('impro-error', "Erreur : Impossible d'accéder à la webcam.");
        }
        console.error(error);
        return null;
      }
    }
    function startTimer() {
      timeRemaining = 120;
      updateCountdownDisplay();
      timerInterval = setInterval(() => {
        timeRemaining--;
        if (timeRemaining >= 0) {
          updateCountdownDisplay();
        }
        if (timeRemaining < 0) {
          clearInterval(timerInterval);
          if (mediaRecorderInstance && mediaRecorderInstance.state === 'recording') {
            mediaRecorderInstance.stop();
            document.getElementById('restart-btn').classList.remove('hidden-btn');
          }
        }
      }, 1000);
    }
    function updateCountdownDisplay() {
      const minutes = Math.floor(timeRemaining / 60);
      const seconds = timeRemaining % 60;
      document.getElementById('countdown').textContent = `${minutes}:${(seconds < 10 ? '0' : '') + seconds}`;
    }
    document.getElementById('stop-btn').addEventListener('click', () => {
      if (mediaRecorderInstance && mediaRecorderInstance.state === 'recording') {
        mediaRecorderInstance.stop();
        clearInterval(countdown);
        clearInterval(timerInterval);
        document.getElementById('stop-btn').classList.add('hidden-btn');
        document.getElementById('stop-btn').disabled = true;
        document.getElementById('restart-btn').classList.remove('hidden-btn');
      }
    });
    document.getElementById('restart-btn').addEventListener('click', () => {
      document.getElementById('restart-btn').classList.add('hidden-btn');
      document.querySelector('.video-overlay').innerHTML = `
        <p>Ton improvisation vidéo va s'enregistrer ici.</p>
        <button id="start-btn" aria-label="Démarrer l'improvisation">
          Démarrer ton impro <i class="fas fa-video"></i>
        </button>
        <p>NB : ta vidéo est stockée sur ton appareil. Aucun enregistrement n'est conservé par Letmotiv.</p>
      `;
      document.querySelector('.video-overlay').style.display = 'flex';
      isImproRecordingStarted = false;
      bindStartButton();
    });
    bindStartButton();

    /***********************
     * NAVIGATION (étapes)
     ***********************/
    function showBox(current, next) {
      if (!boxes[current] || !boxes[next]) return;
      boxes[current].classList.remove('active', 'slide-from-bottom', 'slide-from-top');
      boxes[next].classList.add('active');
      boxes[next].classList.add(next > current ? 'slide-from-bottom' : 'slide-from-top');
      updateProgressBar(next);
      currentStep = next;
      pushStepState(next);
      updateShareButtonVisibility();
      if(next === 3) {
        document.getElementById('current-subject-display').textContent = currentSubject;
      }
    }
    function initNavigationButtons() {
      nextBtns[1].addEventListener('click', () => {
        const selected = document.querySelector('.objectives-container .selected-objective');
        if (!selected) {
          displayError('objective-error', "Sélectionne un objectif avant de continuer.");
          return;
        }
        showBox(1, 2);
      });
      nextBtns[2].addEventListener('click', () => {
        if (!currentSubject) {
          displayError('subject-error', "Tu dois générer un sujet avant de continuer.");
          return;
        }
        document.getElementById('current-subject-display').textContent = currentSubject;
        showBox(2, 3);
      });
      nextBtns[3].addEventListener('click', () => {
        if (!currentSubject || !isImproRecordingStarted) {
          displayError('impro-error', "Tu dois lancer ton improvisation avant de continuer.");
          return;
        }
        showBox(3, 4);
      });
      backBtns[2].addEventListener('click', () => showBox(2, 1));
      backBtns[3].addEventListener('click', () => showBox(3, 2));
      backBtns[4].addEventListener('click', () => showBox(4, 3));
      backBtns[5].addEventListener('click', () => showBox(5, 4));
    }
    initNavigationButtons();

    /***********************
     * STEP4 : Téléchargement, Feedback, Contact
     ***********************/
    document.getElementById('download-video-btn').addEventListener('click', () => {
      if (confirm("Une vidéo va être téléchargée. Continuer ?")) {
        if (videoURL) {
          const link = document.createElement('a');
          link.href = videoURL;
          link.download = 'Letmotiv_Improvisation.mp4';
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          videoDownloaded = true;
          // Rendre le bouton contact actif
          document.getElementById('contact-btn').classList.remove('disabled');
        } else {
          alert("Aucune vidéo disponible.");
        }
      }
    });

    document.getElementById('feedback-btn').addEventListener('click', () => {
      if (document.getElementById('feedback-btn').classList.contains('disabled')) return;
      window.location.href = "https://www.letmotiv.fr/simulateur-prise-de-parole-en-public/feedback-impro";
    });

    document.getElementById('contact-yes').addEventListener('click', (e) => {
      e.preventDefault();
      showBox(4, 5);
    });
    document.getElementById('contact-no').addEventListener('click', (e) => {
      e.preventDefault();
      // Rendre le bouton "Analyse ta prestation" actif
      document.getElementById('feedback-btn').classList.remove('disabled');
    });

    /***********************
     * NEWSLETTER
     ***********************/
    document.getElementById('newsletter-form').addEventListener('submit', (e) => {
      e.preventDefault();
      let valid = true;
      const prenomInput = document.getElementById('newsletter-prenom');
      const emailInput  = document.getElementById('newsletter-email');
      const prenomErrorEl = document.getElementById('newsletter-prenom-error');
      const emailErrorEl  = document.getElementById('newsletter-email-error');
      prenomErrorEl.style.display = 'none';
      emailErrorEl.style.display   = 'none';

      if (prenomInput.value.trim() === "") {
        prenomErrorEl.textContent = "Le prénom est requis.";
        prenomErrorEl.style.display = 'block';
        valid = false;
      }
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (emailInput.value.trim() === "") {
        emailErrorEl.textContent = "L'email est requis.";
        emailErrorEl.style.display = 'block';
        valid = false;
      } else if (!emailRegex.test(emailInput.value.trim())) {
        emailErrorEl.textContent = "L'email n'est pas valide.";
        emailErrorEl.style.display = 'block';
        valid = false;
      }
      if (!valid) return;

      document.getElementById('hidden-prenom').value = prenomInput.value.trim();
      document.getElementById('hidden-email').value = emailInput.value.trim();
      document.getElementById('hidden-google-form').submit();

      const successEl = document.getElementById('newsletter-success');
      successEl.style.display = 'block';
      setTimeout(() => {
        successEl.style.display = 'none';
      }, 5000);
    });

    /***********************
     * PARTAGE
     ***********************/
    class ShareManager {
      constructor() {
        this.shareData = {
          title: "Letmotiv - Simulateur d'entretien",
          text: "Prépare-toi aux entretiens d'embauche et d'admission grâce au simulateur d'entretien Letmotiv.",
          url: window.location.href
        };
        this.bindShareEvents();
      }
      bindShareEvents() {
        const shareBtn = document.getElementById('global-share-btn');
        shareBtn.addEventListener('click', () => {
          if (navigator.share) {
            navigator.share(this.shareData)
              .then(() => console.log('Shared successfully'))
              .catch((error) => console.log('Error sharing', error));
          } else {
            alert("Le partage n'est pas supporté sur ce navigateur.");
          }
        });
      }
    }
    window.addEventListener('DOMContentLoaded', () => {
      new ShareManager();
    });

    /***********************
     * CHARGEMENT INITIAL
     ***********************/
    document.addEventListener('DOMContentLoaded', () => {
      if (window.location.hash) {
        const stepFromHash = window.location.hash.replace('#step', '');
        if (boxes[stepFromHash]) {
          showBox(currentStep, stepFromHash);
        }
      }
    });
  </script>
</body>
</html>
